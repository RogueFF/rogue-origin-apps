    :root {
      --gold: #e4aa4f;
      --gold-light: #f0cb60;
      --gold-dim: rgba(228,170,79,0.12);
      --green: #668971;
      --green-light: #7a9d86;
      --green-dim: rgba(102,137,113,0.12);
      --green-dark: #4a6b54;
      --sungrown: #bf8e4e;
      --sungrown-dim: rgba(191,142,78,0.12);
      --greenhouse: #8f9263;
      --greenhouse-dim: rgba(143,146,99,0.12);
      --indoor: #62758d;
      --indoor-dim: rgba(98,117,141,0.12);
      --danger: #c45c4a;
      --danger-dim: rgba(196,92,74,0.12);
      --bg: #faf8f4;
      --bg-warm: #f3efe7;
      --bg-card: #ffffff;
      --bg-dark: #2d3a2e;
      --border: #e4ddd0;
      --border-light: rgba(102,137,113,0.15);
      --text: #2d3a2e;
      --text-muted: #5a6b5f;
      --text-light: #94a397;
      --header-bg: #2d3a2e;
      --header-text: #faf8f4;
    }
    
    body.dark-mode {
      --bg: #1a1f16;
      --bg-warm: #22291e;
      --bg-card: #252b22;
      --border: rgba(228,170,79,0.2);
      --border-light: rgba(228,170,79,0.1);
      --text: #e8e4dc;
      --text-muted: #a8b5a9;
      --text-light: #6b7a6f;
      --gold-dim: rgba(228,170,79,0.18);
      --green-dim: rgba(102,137,113,0.18);
      --sungrown-dim: rgba(191,142,78,0.18);
      --greenhouse-dim: rgba(143,146,99,0.18);
      --indoor-dim: rgba(98,117,141,0.18);
      --header-bg: #12160f;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
    
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 0;
    }
    
    .main { min-height: 100vh; display: flex; flex-direction: column; position: relative; z-index: 1; }

    .header { 
      background: var(--header-bg); 
      padding: 14px 24px; 
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      border-bottom: 3px solid var(--gold);
      position: sticky; 
      top: 0; 
      z-index: 40;
    }
    .header-left { display: flex; align-items: center; gap: 16px; }
    .header-logo { height: 38px; }
    .header-title { font-size: 18px; font-weight: 600; color: var(--header-text); letter-spacing: -0.3px; }
    .header-right { display: flex; align-items: center; gap: 10px; }
    
    .header-btn { 
      background: rgba(255,255,255,0.08); 
      color: var(--header-text); 
      border: 1px solid rgba(255,255,255,0.15); 
      padding: 8px 14px; 
      border-radius: 8px; 
      font-weight: 500; 
      font-size: 13px; 
      cursor: pointer; 
      display: flex; 
      align-items: center; 
      gap: 6px; 
      transition: all 0.2s; 
    }
    .header-btn:hover { background: rgba(255,255,255,0.15); border-color: rgba(255,255,255,0.25); }
    .header-btn.primary { background: var(--gold); color: var(--header-bg); border-color: var(--gold); font-weight: 600; }
    .header-btn.primary:hover { background: var(--gold-light); }
    
    .dark-mode-toggle { 
      background: rgba(255,255,255,0.08); 
      border: 1px solid rgba(255,255,255,0.15); 
      border-radius: 8px; 
      padding: 8px 12px; 
      cursor: pointer; 
      display: flex; 
      align-items: center; 
      gap: 6px; 
      font-size: 13px; 
      color: var(--header-text); 
    }
    .dark-mode-toggle:hover { background: rgba(255,255,255,0.15); }
    body.dark-mode .dark-mode-toggle { background: var(--gold-dim); border-color: var(--gold); color: var(--gold); }

    .toolbar { 
      background: var(--bg-card); 
      padding: 14px 24px; 
      border-bottom: 1px solid var(--border); 
      display: flex; 
      align-items: center; 
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }
    .toolbar-left { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .toolbar-right { display: flex; align-items: center; gap: 8px; }
    
    .search-box { position: relative; width: 240px; }
    .search-box input { 
      width: 100%;
      background: var(--bg); 
      border: 1px solid var(--border); 
      border-radius: 8px; 
      padding: 10px 12px 10px 38px; 
      color: var(--text); 
      font-size: 13px; 
    }
    .search-box input:focus { outline: none; border-color: var(--green); background: var(--bg-card); }
    .search-box input::placeholder { color: var(--text-light); }
    .search-box i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-light); }
    
    .filter-select { 
      background: var(--bg); 
      border: 1px solid var(--border); 
      border-radius: 8px; 
      padding: 10px 12px; 
      color: var(--text); 
      font-size: 13px; 
      cursor: pointer;
      min-width: 130px;
    }
    .filter-select:focus { outline: none; border-color: var(--green); }
    
    .view-toggle { display: flex; background: var(--bg); border-radius: 8px; padding: 3px; border: 1px solid var(--border); }
    .view-toggle button { 
      padding: 7px 12px; 
      border: none; 
      border-radius: 6px; 
      cursor: pointer; 
      background: transparent; 
      color: var(--text-muted);
      font-size: 16px;
    }
    .view-toggle button.active { background: var(--green); color: #fff; }

    .content { padding: 24px; flex: 1; background: var(--bg); }
    
    .stats-bar { display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap; }
    .stat-card { 
      background: var(--bg-card); 
      border: 1px solid var(--border); 
      border-radius: 12px; 
      padding: 18px 22px; 
      min-width: 130px;
      flex: 1;
      max-width: 180px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
      border-top: 3px solid var(--border);
    }
    .stat-card:nth-child(1) { border-top-color: var(--gold); }
    .stat-card:nth-child(2) { border-top-color: var(--green); }
    .stat-card:nth-child(3) { border-top-color: var(--sungrown); }
    .stat-card:nth-child(4) { border-top-color: var(--danger); }
    .stat-card:nth-child(5) { border-top-color: var(--indoor); }
    .stat-card-label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.8px; color: var(--text-light); margin-bottom: 6px; font-weight: 600; }
    .stat-card-value { font-size: 32px; font-weight: 700; }
    .stat-card-value.gold { color: var(--gold); }
    .stat-card-value.danger { color: var(--danger); }
    .stat-card-value.green { color: var(--green); }
    .stat-card-value.sungrown { color: var(--sungrown); }
    .stat-card-value.indoor { color: var(--indoor); }

    .sop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
    
    .sop-card { 
      background: var(--bg-card); 
      border: 1px solid var(--border); 
      border-radius: 12px; 
      overflow: hidden; 
      transition: all 0.2s;
      cursor: pointer;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }
    .sop-card:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 8px 24px rgba(45,58,46,0.12); 
      border-color: var(--green); 
    }
    
    .sop-card-header { padding: 16px 18px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; background: linear-gradient(to bottom, var(--bg-card), var(--bg)); }
    .sop-card-title { font-size: 15px; font-weight: 600; margin-bottom: 5px; line-height: 1.3; color: var(--text); }
    .sop-card-dept { font-size: 12px; color: var(--text-muted); display: flex; align-items: center; gap: 4px; }
    .sop-card-rev { background: var(--green); color: #fff; font-size: 10px; font-weight: 600; padding: 4px 10px; border-radius: 6px; white-space: nowrap; }
    .sop-card-rev.draft { background: var(--gold); color: var(--header-bg); }
    
    .sop-card-preview { height: 100px; background: var(--bg-warm); display: flex; align-items: center; justify-content: center; overflow: hidden; }
    .sop-card-preview img { width: 100%; height: 100%; object-fit: cover; }
    .sop-card-preview-empty { color: var(--text-light); display: flex; flex-direction: column; align-items: center; gap: 4px; font-size: 12px; }
    .sop-card-preview-empty i { font-size: 28px; opacity: 0.5; }
    
    .sop-card-meta { padding: 12px 18px; display: flex; justify-content: space-between; align-items: center; background: var(--bg); }
    .sop-card-steps { font-size: 12px; color: var(--text-muted); display: flex; align-items: center; gap: 5px; font-weight: 500; }
    .sop-card-tags { display: flex; gap: 5px; flex-wrap: wrap; }
    .sop-tag { background: var(--gold-dim); color: var(--gold); font-size: 9px; font-weight: 700; padding: 3px 7px; border-radius: 4px; text-transform: uppercase; letter-spacing: 0.3px; }
    .sop-tag.danger { background: var(--danger-dim); color: var(--danger); }
    .sop-tag.green { background: var(--green-dim); color: var(--green); }
    .sop-tag.sungrown { background: var(--sungrown-dim); color: var(--sungrown); }
    .sop-tag.greenhouse { background: var(--greenhouse-dim); color: var(--greenhouse); }
    .sop-tag.indoor, .sop-tag.blue { background: var(--indoor-dim); color: var(--indoor); }
    .sop-tag.purple { background: rgba(139,92,246,0.12); color: #8b5cf6; }
    
    .sop-card-actions { display: flex; border-top: 1px solid var(--border); background: var(--bg-card); }
    .sop-card-actions button { 
      flex: 1; 
      background: transparent; 
      border: none; 
      border-right: 1px solid var(--border); 
      padding: 12px; 
      cursor: pointer; 
      color: var(--text-muted);
      transition: all 0.15s;
      font-size: 15px;
    }
    .sop-card-actions button:last-child { border-right: none; }
    .sop-card-actions button:hover { background: var(--green-dim); color: var(--green); }
    .sop-card-actions button.qr-btn:hover { background: var(--gold-dim); color: var(--gold); }
    .sop-card-actions button.del-btn:hover { background: var(--danger-dim); color: var(--danger); }

    .sop-list { display: none; }
    .sop-list.active { display: block; }
    .sop-grid.hidden { display: none; }
    
    .sop-table { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.04); }
    .sop-table table { width: 100%; border-collapse: collapse; }
    .sop-table th { text-align: left; padding: 14px 18px; background: var(--bg); font-size: 10px; text-transform: uppercase; letter-spacing: 0.8px; color: var(--text-muted); font-weight: 700; border-bottom: 1px solid var(--border); }
    .sop-table td { padding: 14px 18px; border-bottom: 1px solid var(--border); font-size: 13px; }
    .sop-table tr:last-child td { border-bottom: none; }
    .sop-table tr:hover { background: var(--bg); cursor: pointer; }
    .sop-table .title-cell { font-weight: 600; color: var(--green); }
    .sop-table .actions-cell { display: flex; gap: 6px; }
    .sop-table .actions-cell button { background: var(--bg); border: 1px solid var(--border); padding: 6px 10px; border-radius: 6px; cursor: pointer; color: var(--text-muted); font-size: 14px; }
    .sop-table .actions-cell button:hover { border-color: var(--green); color: var(--green); background: var(--green-dim); }

    .empty-state { text-align: center; padding: 60px 20px; color: var(--text-muted); }
    .empty-state i { font-size: 64px; margin-bottom: 16px; color: var(--green); opacity: 0.4; }
    .empty-state h3 { font-size: 18px; font-weight: 600; color: var(--text); margin-bottom: 8px; }
    .empty-state p { margin-bottom: 20px; }

    .loading-state { text-align: center; padding: 60px 20px; color: var(--text-muted); }
    .loading-state .spinner { width: 48px; height: 48px; border: 4px solid var(--border); border-top-color: var(--green); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px; }
    @keyframes spin { to { transform: rotate(360deg); } }

    .modal { position: fixed; inset: 0; background: rgba(26,31,22,0.6); display: none; align-items: center; justify-content: center; padding: 20px; z-index: 100; backdrop-filter: blur(4px); }
    .modal.active { display: flex; }
    
    .modal-box { background: var(--bg-card); border-radius: 16px; width: 100%; max-width: 900px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
    .modal-box.wide { max-width: 1100px; }
    .modal-box.small { max-width: 500px; }
    
    .modal-header { padding: 20px 24px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: var(--header-bg); }
    .modal-header h2 { font-size: 17px; font-weight: 600; display: flex; align-items: center; gap: 10px; color: var(--header-text); }
    .modal-close { background: rgba(255,255,255,0.1); border: none; color: var(--header-text); font-size: 20px; cursor: pointer; padding: 6px 10px; border-radius: 6px; line-height: 1; }
    .modal-close:hover { background: rgba(255,255,255,0.2); }
    
    .modal-body { padding: 24px; overflow-y: auto; flex: 1; background: var(--bg-card); }
    .modal-footer { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 10px; background: var(--bg); }
    
    .modal-footer .header-btn { 
      background: var(--bg-card); 
      color: var(--text-muted); 
      border: 1px solid var(--border); 
    }
    .modal-footer .header-btn:hover { background: var(--green-dim); color: var(--green); border-color: var(--green); }
    .modal-footer .header-btn.primary { background: var(--green); color: #fff; border-color: var(--green); }
    .modal-footer .header-btn.primary:hover { background: var(--green-dark); }

    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-size: 11px; font-weight: 700; color: var(--text-muted); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
    .form-input { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 12px; color: var(--text); font-size: 14px; }
    .form-input:focus { outline: none; border-color: var(--green); background: var(--bg-card); }
    textarea.form-input { min-height: 80px; resize: vertical; font-family: inherit; }
    
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }

    .steps-section { margin-top: 24px; }
    .steps-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .steps-header h3 { font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 8px; color: var(--text); }
    .steps-list { display: flex; flex-direction: column; gap: 12px; }
    
    .step-item { background: var(--bg); border: 1px solid var(--border); border-radius: 10px; padding: 16px; display: flex; gap: 16px; }
    .step-item:hover { border-color: var(--green); }
    .step-number { width: 32px; height: 32px; background: var(--green); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 13px; flex-shrink: 0; }
    .step-content { flex: 1; min-width: 0; }
    .step-title-input { width: 100%; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; padding: 10px; color: var(--text); font-size: 14px; font-weight: 600; margin-bottom: 8px; }
    .step-title-input:focus { outline: none; border-color: var(--green); }
    .step-desc-input { width: 100%; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; padding: 10px; color: var(--text); font-size: 13px; min-height: 50px; resize: vertical; font-family: inherit; }
    .step-desc-input:focus { outline: none; border-color: var(--green); }
    
    .step-image { width: 140px; flex-shrink: 0; }
    .step-image-preview { width: 100%; height: 120px; background: var(--bg-card); border: 2px dashed var(--border); border-radius: 8px; display: flex; align-items: center; justify-content: center; overflow: hidden; cursor: pointer; position: relative; }
    .step-image-preview:hover { border-color: var(--gold); background: var(--gold-dim); }
    .step-image-preview.has-image { border-style: solid; }
    .step-image-preview img { width: 100%; height: 100%; object-fit: cover; }
    .step-image-preview .placeholder { color: var(--text-light); font-size: 10px; text-align: center; }
    .step-image-preview .placeholder i { font-size: 20px; display: block; margin-bottom: 4px; }
    
    .step-icons { display: flex; gap: 6px; margin-top: 8px; }
    .step-icon-btn { width: 30px; height: 30px; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-card); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; color: var(--text-muted); }
    .step-icon-btn:hover { border-color: var(--gold); color: var(--gold); }
    .step-icon-btn.active { background: var(--gold); color: #fff; border-color: var(--gold); }
    .step-icon-btn.safety.active { background: var(--danger); border-color: var(--danger); }
    .step-icon-btn.quality.active { background: var(--green); border-color: var(--green); }
    
    .step-actions { display: flex; flex-direction: column; gap: 4px; }
    .step-action-btn { width: 30px; height: 30px; border: none; border-radius: 6px; background: var(--bg-card); cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 14px; }
    .step-action-btn:hover { background: var(--border); }
    .step-action-btn.delete:hover { background: var(--danger-dim); color: var(--danger); }

    .inline-add-btn { width: 38px; height: 38px; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-muted); font-size: 16px; flex-shrink: 0; }
    .inline-add-btn:hover { border-color: var(--green); color: var(--green); background: var(--green-dim); }
    .inline-add-btn.save { background: var(--green); color: #fff; border-color: var(--green); }
    .inline-add-btn.save:hover { background: var(--green-dark); }
    .inline-add-btn.cancel { background: var(--bg); }
    .inline-add-btn.cancel:hover { border-color: var(--danger); color: var(--danger); background: var(--danger-dim); }
    
    .tag-item { display: flex; align-items: center; gap: 4px; }
    .tag-item .tag-delete { background: none; border: none; color: var(--text-light); cursor: pointer; font-size: 12px; padding: 2px; border-radius: 3px; opacity: 0.6; }
    .tag-item .tag-delete:hover { color: var(--danger); opacity: 1; }
    .add-tag-btn { background: var(--bg); border: 1px dashed var(--border); border-radius: 6px; padding: 3px 10px; font-size: 11px; color: var(--text-light); cursor: pointer; display: flex; align-items: center; gap: 4px; }
    .add-tag-btn:hover { border-color: var(--green); color: var(--green); border-style: solid; }
    .tag-color-picker-mini { display: flex; gap: 4px; }
    .tag-color-picker-mini .color-dot { width: 20px; height: 20px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
    .tag-color-picker-mini .color-dot:hover { transform: scale(1.15); }
    .tag-color-picker-mini .color-dot.selected { border-color: var(--text); }

    .qr-modal-content { text-align: center; padding: 20px; }
    .qr-url { background: var(--bg); padding: 12px; border-radius: 8px; font-size: 11px; color: var(--text-muted); word-break: break-all; margin-top: 16px; }

    .view-sop-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
    .view-sop-title { font-size: 22px; font-weight: 700; margin-bottom: 8px; color: var(--text); }
    .view-sop-meta { display: flex; gap: 16px; flex-wrap: wrap; }
    .view-sop-meta-item { font-size: 13px; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }
    .view-sop-qr { width: 90px; height: 90px; background: #fff; border-radius: 8px; padding: 6px; flex-shrink: 0; border: 1px solid var(--border); }
    
    .view-step { display: flex; gap: 16px; padding: 18px; background: var(--bg); border-radius: 10px; margin-bottom: 12px; border-left: 4px solid var(--green); }
    .view-step-number { width: 40px; height: 40px; background: var(--green); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 16px; flex-shrink: 0; }
    .view-step-content { flex: 1; }
    .view-step-title { font-size: 15px; font-weight: 600; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; color: var(--text); }
    .view-step-title .icon.safety { color: var(--danger); }
    .view-step-title .icon.quality { color: var(--green); }
    .view-step-desc { font-size: 13px; color: var(--text-muted); line-height: 1.5; }
    .view-step-image { width: 160px; height: 100px; border-radius: 8px; overflow: hidden; flex-shrink: 0; border: 2px solid var(--border); }
    .view-step-image img { width: 100%; height: 100%; object-fit: cover; }

    .settings-section { margin-bottom: 28px; }
    .settings-section-title { font-size: 13px; font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; color: var(--text); }
    .settings-section-title i { color: var(--green); font-size: 18px; }
    .settings-list { display: flex; flex-wrap: wrap; gap: 8px; }
    .settings-item { display: flex; align-items: center; gap: 8px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; font-size: 13px; }
    .settings-item:hover { border-color: var(--green); }
    .settings-item .item-delete { background: none; border: none; color: var(--text-light); cursor: pointer; padding: 2px; border-radius: 4px; font-size: 14px; }
    .settings-item .item-delete:hover { color: var(--danger); background: var(--danger-dim); }
    .settings-add-form { display: flex; gap: 8px; margin-top: 12px; }
    .settings-add-form input { flex: 1; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 10px 12px; font-size: 13px; color: var(--text); }
    .settings-add-form input:focus { outline: none; border-color: var(--green); }
    .settings-add-btn { background: var(--green); color: white; border: none; border-radius: 8px; padding: 10px 14px; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; }
    .settings-add-btn:hover { background: var(--green-dark); }
    .settings-note { font-size: 11px; color: var(--text-light); margin-top: 8px; }
    .tag-color-picker { display: flex; gap: 6px; align-items: center; }
    .tag-color-option { width: 24px; height: 24px; border-radius: 6px; border: 2px solid transparent; cursor: pointer; }
    .tag-color-option:hover { transform: scale(1.1); }
    .tag-color-option.selected { border-color: var(--text); box-shadow: 0 0 0 2px var(--bg-card); }
    .tag-color-option.gold { background: var(--gold); }
    .tag-color-option.green { background: var(--green); }
    .tag-color-option.danger { background: var(--danger); }
    .tag-color-option.sungrown { background: var(--sungrown); }
    .tag-color-option.greenhouse { background: var(--greenhouse); }
    .tag-color-option.indoor { background: var(--indoor); }

    .lang-toggle { display: flex; background: var(--bg); border-radius: 8px; padding: 3px; border: 1px solid var(--border); }
    .lang-toggle button { padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; background: transparent; color: var(--text-muted); font-size: 12px; font-weight: 600; }
    .lang-toggle button.active { background: var(--green); color: #fff; }
    .lang-toggle button:hover:not(.active) { background: var(--bg-warm); }
    .translate-btn { background: var(--sungrown-dim); border: 1px solid var(--sungrown); color: var(--sungrown); padding: 8px 14px; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; }
    .translate-btn:hover { background: var(--sungrown); color: #fff; }
    .translate-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .translation-notice { background: var(--sungrown-dim); border: 1px solid var(--sungrown); border-radius: 8px; padding: 10px 14px; font-size: 12px; color: var(--sungrown); margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }

    .pdf-layout-options { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 20px; }
    .pdf-layout-option { cursor: pointer; }
    .pdf-layout-option input { display: none; }
    .pdf-layout-card { width: 100px; padding: 12px; border: 2px solid var(--border); border-radius: 10px; text-align: center; transition: all 0.2s; background: var(--bg-card); }
    .pdf-layout-card:hover { border-color: var(--green); }
    .pdf-layout-option input:checked + .pdf-layout-card { border-color: var(--green); background: var(--green-dim); }
    .pdf-layout-preview { height: 50px; background: var(--bg); border-radius: 4px; margin-bottom: 8px; padding: 6px; display: flex; flex-direction: column; justify-content: center; gap: 3px; }
    .pdf-layout-preview .line { height: 4px; background: var(--border); border-radius: 2px; }
    .pdf-layout-preview .line.short { width: 60%; }
    .pdf-layout-preview.grid-preview { display: grid; gap: 4px; align-content: center; }
    .pdf-layout-preview.grid-preview.cols-1 { grid-template-columns: 1fr; }
    .pdf-layout-preview.grid-preview.cols-2 { grid-template-columns: 1fr 1fr; }
    .pdf-layout-preview .box { background: var(--green); opacity: 0.3; border-radius: 2px; min-height: 16px; }
    .pdf-layout-card span { font-size: 11px; color: var(--text-muted); font-weight: 500; }

    .request-badge { background: var(--danger); color: #fff; font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 10px; margin-left: 4px; }

    .requests-tabs { display: flex; gap: 4px; margin-bottom: 16px; background: var(--bg); padding: 4px; border-radius: 10px; }
    .requests-tab { flex: 1; padding: 10px 16px; border: none; background: transparent; color: var(--text-muted); font-size: 13px; font-weight: 500; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
    .requests-tab:hover { background: var(--bg-card); }
    .requests-tab.active { background: var(--bg-card); color: var(--text); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .requests-tab .tab-count { background: var(--gold-dim); color: var(--gold); padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 6px; }
    .requests-tab.active .tab-count { background: var(--gold); color: #fff; }
    
    .request-list { display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto; }
    .request-item { background: var(--bg); border: 1px solid var(--border); border-radius: 10px; padding: 14px; transition: all 0.2s; }
    .request-item:hover { border-color: var(--green); }
    .request-item.completed { opacity: 0.6; }
    .request-item-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; margin-bottom: 8px; }
    .request-item-title { font-weight: 600; color: var(--text); font-size: 14px; flex: 1; }
    .request-item-priority { font-size: 10px; font-weight: 600; padding: 3px 8px; border-radius: 6px; text-transform: uppercase; }
    .request-item-priority.high { background: var(--danger-dim); color: var(--danger); }
    .request-item-priority.medium { background: var(--gold-dim); color: var(--gold); }
    .request-item-priority.low { background: var(--green-dim); color: var(--green); }
    .request-item-desc { font-size: 12px; color: var(--text-muted); margin-bottom: 10px; line-height: 1.5; }
    .request-item-meta { display: flex; gap: 16px; font-size: 11px; color: var(--text-light); flex-wrap: wrap; align-items: center; }
    .request-item-meta i { margin-right: 4px; }
    .request-item-actions { display: flex; gap: 6px; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); }
    .request-item-actions button { padding: 6px 12px; font-size: 11px; border-radius: 6px; border: none; cursor: pointer; display: flex; align-items: center; gap: 4px; transition: all 0.2s; }
    .request-action-create { background: var(--green); color: #fff; }
    .request-action-create:hover { background: var(--green-dark); }
    .request-action-complete { background: var(--gold-dim); color: var(--gold); }
    .request-action-complete:hover { background: var(--gold); color: #fff; }
    .request-action-delete { background: var(--danger-dim); color: var(--danger); }
    .request-action-delete:hover { background: var(--danger); color: #fff; }
    .request-action-edit { background: var(--bg-card); color: var(--text-muted); border: 1px solid var(--border); }
    .request-action-edit:hover { border-color: var(--green); color: var(--green); }
    
    .request-empty { text-align: center; padding: 40px 20px; color: var(--text-muted); }
    .request-empty i { font-size: 48px; margin-bottom: 12px; opacity: 0.3; }
    .request-empty p { font-size: 14px; }
    
    .add-request-form { background: var(--bg); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin-bottom: 16px; }
    .add-request-form .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .add-request-form .form-input { font-size: 13px; padding: 10px 12px; }
    .add-request-form .form-label { font-size: 11px; margin-bottom: 4px; }

    .ai-improve-btn { background: linear-gradient(135deg, var(--gold) 0%, var(--sungrown) 100%); color: #fff; border: none; padding: 4px 10px; border-radius: 6px; font-size: 10px; font-weight: 600; cursor: pointer; margin-left: 8px; transition: all 0.2s; display: inline-flex; align-items: center; gap: 4px; vertical-align: middle; }
    .ai-improve-btn:hover { transform: scale(1.05); box-shadow: 0 2px 8px rgba(228,170,79,0.4); }
    .ai-improve-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .ai-improve-btn.loading { animation: pulse 1s infinite; }
    .ai-improve-btn i { font-size: 12px; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
    
    .step-ai-btn { background: linear-gradient(135deg, var(--gold) 0%, var(--sungrown) 100%); color: #fff; border: none; width: 28px; height: 28px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
    .step-ai-btn:hover { transform: scale(1.1); box-shadow: 0 2px 8px rgba(228,170,79,0.4); }
    .step-ai-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .step-ai-btn i { font-size: 14px; }

    .lang-switch { background: var(--gold); color: #fff; border: none; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; transition: all 0.2s; }
    .lang-switch:hover { background: var(--gold-light); transform: scale(1.05); }
    .lang-switch i { font-size: 16px; }

    .toast { position: fixed; bottom: 24px; right: 24px; padding: 14px 20px; border-radius: 10px; color: #fff; font-size: 14px; z-index: 200; box-shadow: 0 4px 20px rgba(0,0,0,0.25); display: none; align-items: center; gap: 10px; }
    .toast.show { display: flex; animation: slideIn 0.3s ease; }
    .toast.success { background: var(--green); }
    .toast.error { background: var(--danger); }
    @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    @media (max-width: 768px) {
      .sop-grid { grid-template-columns: 1fr; }
      .form-row, .form-row-3 { grid-template-columns: 1fr; }
      .step-item { flex-direction: column; }
      .step-image { width: 100%; }
      .toolbar-left { width: 100%; }
      .search-box { width: 100%; }
      .header-right { flex-wrap: wrap; }
    }
    
    @media (min-width: 768px) and (max-width: 1024px) {
      .sop-grid { grid-template-columns: repeat(2, 1fr); gap: 16px; }
      .form-input, .filter-select { font-size: 16px !important; padding: 14px 16px; }
      .step-title-input, .step-desc-input { font-size: 16px !important; padding: 14px; }
      .step-action-btn, .step-ai-btn { width: 44px; height: 44px; }
      .step-icon-btn { width: 44px; height: 44px; }
      .header-btn { padding: 12px 18px; font-size: 14px; }
      .inline-add-btn { width: 44px; height: 44px; }
    }
    
    @media (pointer: coarse) {
      .header-btn, .inline-add-btn, .step-action-btn, .step-ai-btn, .step-icon-btn, 
      .sop-card-actions button, .settings-add-btn, .request-item-actions button {
        min-height: 44px;
        min-width: 44px;
      }
    }
  </style>
