<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

## 2026-01-13: Bag Counting Fix

**Issue**: Order progress showing 0/120kg on scoreboard instead of actual completion (35kg)

**Root Cause**:
- Bag scanning webhook adds new entries to the TOP of "Rogue Origin Production Tracking" sheet
- `count5kgBagsForStrain()` function was reading from BOTTOM of sheet (last 500 rows)
- Result: Function was reading oldest bags (from weeks ago) instead of newest bags

**Fix Applied**:
- Changed row reading strategy from bottom-up to top-down
- Now reads rows 2-2001 (first 2000 data rows after header)
- This captures newest 2000 bags, covering 1-2 weeks of production

**Code Changes** (Code.gs:1535-1546):
```javascript
// BEFORE: Read from bottom
var startRow = Math.max(2, lastRow - 499);

// AFTER: Read from top
var startRow = 2; // First data row (row 1 is headers)
var numRows = Math.min(2000, lastRow - 1);
```

**Performance**:
- API response time: ~4 seconds (acceptable)
- Covers sufficient data window for active orders (1-2 weeks)
- Prevents reading entire sheet (thousands of rows, causing timeouts)

**Result**:
- Progress now shows correctly: 35/120kg (7 bags × 5kg)
- Automatic bag counting works as designed
- Scoreboard order queue displays accurate completion status

**Status**: ✅ Deployed and verified working

</claude-mem-context>