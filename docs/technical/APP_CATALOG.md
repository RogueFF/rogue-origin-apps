# Rogue Origin - Master App Catalog

> **Last Updated**: January 2, 2026  
> **Version**: 2.0 (AI Agent Release)  
> **Purpose**: Complete technical reference for all production applications

---

## Table of Contents

1. [System Overview](#system-overview)
2. [App 1: Ops Hub + AI Agent](#app-1-ops-hub--ai-agent)
3. [App 2: Hourly Production Tracker](#app-2-hourly-production-tracker)
4. [App 3: SOP Manager](#app-3-sop-manager)
5. [App 4: Kanban Board](#app-4-kanban-board)
6. [App 5: Barcode Manager](#app-5-barcode-manager)
7. [App 6: Wholesale Orders System](#app-6-wholesale-orders-system)
8. [Data Schemas](#data-schemas)
9. [API Reference](#api-reference)
10. [Shared Utilities](#shared-utilities)
11. [Integration Points](#integration-points)

---

## System Overview

### Complete Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 USER DEVICES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± Mobile (Boss)     ğŸ’» Desktop (Koa)     ğŸ“º TV Display     ğŸ“± Tablet (Floor)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ HTTPS
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND LAYER                                      â”‚
â”‚                    GitHub Pages (rogueff.github.io/rogue-origin-apps/)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           Static HTML/CSS/JS                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚ ops-hub    â”‚ scoreboard â”‚sop-manager â”‚ kanban     â”‚ barcode    â”‚         â”‚   â”‚
â”‚  â”‚ .html      â”‚ .html      â”‚ .html      â”‚ .html      â”‚ .html      â”‚         â”‚   â”‚
â”‚  â”‚            â”‚            â”‚            â”‚            â”‚            â”‚         â”‚   â”‚
â”‚  â”‚ ~2,300 ln  â”‚ ~468KB     â”‚ ~1,500 ln  â”‚ ~600 ln    â”‚ ~700 ln    â”‚         â”‚   â”‚
â”‚  â”‚            â”‚ (w/charts) â”‚            â”‚            â”‚            â”‚         â”‚   â”‚
â”‚  â”‚ Features:  â”‚ Features:  â”‚ Features:  â”‚ Features:  â”‚ Features:  â”‚         â”‚   â”‚
â”‚  â”‚ â€¢ AI Chat  â”‚ â€¢ Live     â”‚ â€¢ CRUD     â”‚ â€¢ Columns  â”‚ â€¢ SKU mgmt â”‚         â”‚   â”‚
â”‚  â”‚ â€¢ Tiles    â”‚   metrics  â”‚ â€¢ PDF      â”‚ â€¢ D&D      â”‚ â€¢ Barcodes â”‚         â”‚   â”‚
â”‚  â”‚ â€¢ Quick    â”‚ â€¢ Charts   â”‚ â€¢ AI gen   â”‚ â€¢ Filters  â”‚ â€¢ Labels   â”‚         â”‚   â”‚
â”‚  â”‚   actions  â”‚ â€¢ Auto-    â”‚ â€¢ ES/EN    â”‚ â€¢ Archive  â”‚ â€¢ Printing â”‚         â”‚   â”‚
â”‚  â”‚ â€¢ Mobile   â”‚   refresh  â”‚ â€¢ Images   â”‚            â”‚            â”‚         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚                                                                                  â”‚
â”‚  Dual-Mode Support:                                                              â”‚
â”‚  â€¢ GitHub Pages â†’ fetch() API calls                                              â”‚
â”‚  â€¢ Apps Script â†’ google.script.run                                              â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ fetch() with text/plain (CORS-safe)
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              BACKEND LAYER                                       â”‚
â”‚                       Google Apps Script Web Apps                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    PRODUCTION TRACKING (Code.gs)                          â”‚   â”‚
â”‚  â”‚                    ~1,900 lines (with AI Agent)                           â”‚   â”‚
â”‚  â”‚                                                                           â”‚   â”‚
â”‚  â”‚  Sheet ID: 1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is                   â”‚   â”‚
â”‚  â”‚  Deployment: AKfycbxDAHSFl9cedGS49L3Lf5ztqy-SSToYigyA30ZtsdpmWNAR9H61X... â”‚   â”‚
â”‚  â”‚                                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Core Functions (45+)                                                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ WEB APP HANDLERS:                                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ doGet(e) - Route GET requests                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ doPost(e) - Route POST requests                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ onOpen() - Add menu items                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ SCOREBOARD:                                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getScoreboardData() - Line 1 production metrics                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getScoreboardWithTimerData() - Combined scoreboard + bags         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ buildDashboardData() - Full dashboard dataset                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getDashboardDataLive() - Live wrapper                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ BAG TIMER:                                                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getBagTimerData() - Bag counts, cycles                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ logManualBagCompletion(size) - Manual bag entry                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ logTimerPause(reason, duration) - Break start                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ logTimerResume(pauseId, duration) - Break end                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ is5kgBag(size) - Check bag type                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ is10lbTopsBag(size, sku) - Check bag type                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ CREW MANAGEMENT:                                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ showCrewChangeSidebar() - Open crew UI                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ setCrewCounts(b1, b2, t1, t2) - Update counts                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getCrewSnapshotForActiveRow() - Current crew                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getCrewChangeLog_() - History log                                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ HISTORICAL DATA:                                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getExtendedDailyDataLine1_(ss, tz, days) - N-day history          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getDailyStrainBreakdown_(ss, tz, days) - Strain by day            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getStrainHistoricalRate_(ss, tz, strain, days) - Rate lookup      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getComparisonDataLine1_(ss, tz, ...) - Compare periods            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ calculateDayPercentageAtHourLine1_(...) - Point-in-time           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ GENERATION:                                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ generateHourlyProductionTable() - Create daily template           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ generateMasterSheet() - Consolidate data                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ setupMonthlySheet(sheet) - Initialize month                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ LEAD TIME:                                                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ showLeadTimeEstimator() - Open estimator                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ calculateLeadTimeEstimator(formData) - Calculate ETA              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ addWorkHours(start, hours, ...) - Work calendar math              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ AI AGENT (NEW):                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ handleChatRequest(data) - Main entry point                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ gatherProductionContext() - Collect all data                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ gatherHistoricalData(ss, tz) - 30-day analysis                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ buildSystemPrompt(context, corrections) - AI context              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ callAnthropicForChat(system, history, msg) - API call             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ extractCorrections(history) - Detect corrections                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getRecentCorrections() - Load saved                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ saveCorrection(text, category) - Persist                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ logChatForTraining(msg, resp, turn) - Log chat                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ logChatFeedback(feedback) - Log ğŸ‘/ğŸ‘                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ UTILITIES:                                                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ jsonResponse(data) - Create JSON output                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getLatestMonthSheet_(ss) - Find current tab                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ findDateRow_(vals, dateLabel) - Row lookup                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getColumnIndices_(headers) - Column mapping                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ isEndOfBlock_(row) - Detect table end                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getTimeSlotMultiplier(timeSlot) - Calc factor                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getTodayHourlyTrimmers_(ss, tz) - Trimmer counts                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getTrimmersForHour_(hourly, hour, fallback) - Hour lookup         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getCultivarList() - List strains                                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getUiLocale() - Get language                                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ isSameDay(d1, d2) - Date compare                                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ CONTEXT HELPERS:                                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ assertMonthSheet_(sheetName) - Validate sheet                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ isValidHrxrDataRow_(sheet, row) - Validate row                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getActiveHrxrContext_() - Get active context                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ readCrewFromRow_(ctx) - Read crew data                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ jumpToNewestHrHr_() - Navigate to latest                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ TIMER:                                                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ showThroughputTimer() - Open timer UI                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ ORDERS (Partial):                                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ updateOrderStatuses_(ss) - Status updates                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ computeOrderProgress_(ss, tz, current) - Progress                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ computeProductionForCultivarSince_(...) - Cultivar prod           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ getOrCreateOrdersSheet_() - Get orders tab                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ saveOrdersFromEstimator(formData) - Save order                    â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                           â”‚   â”‚
â”‚  â”‚  HTML Templates (Bound Mode):                                             â”‚   â”‚
â”‚  â”‚  â€¢ ProductionScoreboard.html - Floor TV display (~60KB)                   â”‚   â”‚
â”‚  â”‚  â€¢ CrewChangeSidebar.html - Crew adjustment UI                            â”‚   â”‚
â”‚  â”‚  â€¢ LeadTimeEstimatorSidebar.html - Order estimation (~14KB)               â”‚   â”‚
â”‚  â”‚  â€¢ ThroughputTimerSidebar.html - Timer controls (~8KB)                    â”‚   â”‚
â”‚  â”‚  â€¢ ProductionDashboard.html - Dashboard view (~63KB)                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ SOP MANAGER (Code.gs)     â”‚  â”‚ KANBAN (Code.gs)          â”‚                   â”‚
â”‚  â”‚                           â”‚  â”‚                           â”‚                   â”‚
â”‚  â”‚ â€¢ doGet(e)                â”‚  â”‚ Sheet ID:                 â”‚                   â”‚
â”‚  â”‚ â€¢ doPost(e)               â”‚  â”‚ 19UW_tWY6c53lEydXqULAqC3  â”‚                   â”‚
â”‚  â”‚ â€¢ getSOPs()               â”‚  â”‚ Ffv1C20PDZMKnV6K-byQ      â”‚                   â”‚
â”‚  â”‚ â€¢ saveSOP(data)           â”‚  â”‚                           â”‚                   â”‚
â”‚  â”‚ â€¢ deleteSOP(id)           â”‚  â”‚ â€¢ doGet(e)                â”‚                   â”‚
â”‚  â”‚ â€¢ proxyAnthropicCall()    â”‚  â”‚ â€¢ doPost(e)               â”‚                   â”‚
â”‚  â”‚                           â”‚  â”‚ â€¢ getCards()              â”‚                   â”‚
â”‚  â”‚ Tab: SOPs                 â”‚  â”‚ â€¢ addCard(data)           â”‚                   â”‚
â”‚  â”‚ Columns: ID, Title,       â”‚  â”‚ â€¢ updateCard(data)        â”‚                   â”‚
â”‚  â”‚ Category, Steps,          â”‚  â”‚ â€¢ deleteCard(id)          â”‚                   â”‚
â”‚  â”‚ CreatedDate, etc.         â”‚  â”‚ â€¢ fetchProductInfo(url)   â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ BARCODE MANAGER (Code.gs)                                                 â”‚  â”‚
â”‚  â”‚ Sheet ID: 1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE                    â”‚  â”‚
â”‚  â”‚                                                                           â”‚  â”‚
â”‚  â”‚ â€¢ doGet(e) - Serve page or API                                            â”‚  â”‚
â”‚  â”‚ â€¢ doPost(e) - Handle CRUD                                                 â”‚  â”‚
â”‚  â”‚ â€¢ getProducts() - List all products                                       â”‚  â”‚
â”‚  â”‚ â€¢ addProduct(data) - Create product                                       â”‚  â”‚
â”‚  â”‚ â€¢ updateProduct(data) - Update product                                    â”‚  â”‚
â”‚  â”‚ â€¢ deleteProduct(id) - Remove product                                      â”‚  â”‚
â”‚  â”‚ â€¢ importCSV(data) - Bulk import                                           â”‚  â”‚
â”‚  â”‚                                                                           â”‚  â”‚
â”‚  â”‚ Tab: Products                                                             â”‚  â”‚
â”‚  â”‚ Columns: SKU, Name, Weight, Unit, Price, BarcodeData, Active              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              EXTERNAL SERVICES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ANTHROPIC CLAUDE API â”‚  â”‚ SHOPIFY WEBHOOKS     â”‚  â”‚ TEC-IT BARCODE       â”‚   â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚   â”‚
â”‚  â”‚ Endpoint:            â”‚  â”‚ Trigger:             â”‚  â”‚ Endpoint:            â”‚   â”‚
â”‚  â”‚ api.anthropic.com/   â”‚  â”‚ Order fulfillment    â”‚  â”‚ barcode.tec-it.com/  â”‚   â”‚
â”‚  â”‚ v1/messages          â”‚  â”‚ Bag tagged           â”‚  â”‚ barcode.ashx         â”‚   â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚   â”‚
â”‚  â”‚ Model:               â”‚  â”‚ Payload:             â”‚  â”‚ Params:              â”‚   â”‚
â”‚  â”‚ claude-sonnet-4-20250514      â”‚  â”‚ Line items,          â”‚  â”‚ data=[SKU]           â”‚   â”‚
â”‚  â”‚                      â”‚  â”‚ Timestamps,          â”‚  â”‚ code=Code128         â”‚   â”‚
â”‚  â”‚ Max tokens: 1024     â”‚  â”‚ SKUs                 â”‚  â”‚                      â”‚   â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚ Returns: Image       â”‚   â”‚
â”‚  â”‚ Key: Script Props    â”‚  â”‚ Target: Production   â”‚  â”‚                      â”‚   â”‚
â”‚  â”‚ ANTHROPIC_API_KEY    â”‚  â”‚ Tracking sheet       â”‚  â”‚ Free tier available  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               DATA LAYER                                         â”‚
â”‚                            Google Sheets                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  PRODUCTION SHEET (1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: YYYY-MM (e.g., 2026-01)                                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Hour-by-hour production data                                â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Structure:                                                           â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Row 1: Headers                                                       â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Row 2: (Date row header like "Thursday, January 2, 2025")            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Rows 3-11: Hourly data (7AM, 8AM, 9AM, 10AM, 11AM, 12PM, 1PM, 2PM, 3PM)â”‚â”‚
â”‚  â”‚  â”‚ Row 12: (blank/separator)                                            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Row 13: Next date...                                                 â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Time Slot (e.g., "7:00 AM")                                       â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: Buckers Line 1                                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: Buckers Line 2                                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: Trimmers Line 1                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ E: Trimmers Line 2                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ F: Cultivar (e.g., "RO24-047 - Sour Lifter / Sungrown")              â”‚   â”‚â”‚
â”‚  â”‚  â”‚ G: Tops (lbs)                                                        â”‚   â”‚â”‚
â”‚  â”‚  â”‚ H: Smalls (lbs)                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ I: Trimmer Wage Rate                                                 â”‚   â”‚â”‚
â”‚  â”‚  â”‚ J: Trim Cost                                                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ K: (Additional columns as needed)                                    â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: Rogue Origin Production Tracking                                â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Shopify webhook bag completion log                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Timestamp (ISO format)                                            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: Bag Type (e.g., "5kg", "10lb")                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: Weight (lbs)                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: SKU                                                               â”‚   â”‚â”‚
â”‚  â”‚  â”‚ E: Source (webhook/manual)                                           â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Populated by: Shopify webhook or logManualBagCompletion()            â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: Timer Pause Log                                                 â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Track break/pause periods                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Pause ID (UUID)                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: Start Time                                                        â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: End Time                                                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: Reason (e.g., "Lunch", "Morning Break", "Equipment")              â”‚   â”‚â”‚
â”‚  â”‚  â”‚ E: Estimated Duration (minutes)                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ F: Actual Duration (seconds)                                         â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: CrewChangeLog                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Track crew count changes                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Timestamp                                                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: Previous Buckers L1                                               â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: Previous Buckers L2                                               â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: Previous Trimmers L1                                              â”‚   â”‚â”‚
â”‚  â”‚  â”‚ E: Previous Trimmers L2                                              â”‚   â”‚â”‚
â”‚  â”‚  â”‚ F: New Buckers L1                                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚ G: New Buckers L2                                                    â”‚   â”‚â”‚
â”‚  â”‚  â”‚ H: New Trimmers L1                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ I: New Trimmers L2                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ J: User/Source                                                       â”‚   â”‚â”‚
â”‚  â”‚  â”‚ K: Notes                                                             â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: Data                                                            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Reference data, configuration                               â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Sections:                                                            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ â€¢ Cultivar List (strain names, target rates)                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ â€¢ Wage Rates (by date, hourly rates)                                 â”‚   â”‚â”‚
â”‚  â”‚  â”‚ â€¢ Target Rates (lbs/trimmer/hour by strain)                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ â€¢ Configuration (work hours, break times)                            â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: Master                                                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Auto-generated consolidation of all months                  â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Generated by: generateMasterSheet()                                  â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Contains: Daily totals, running averages                             â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: AI_Chat_Log (NEW)                                               â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: AI conversation history for training                        â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Timestamp                                                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: User Question                                                     â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: AI Response (truncated to 500 chars)                              â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: Conversation Turn Number                                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ E: Feedback (good/bad/null)                                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ F: Notes                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Populated by: logChatForTraining(), logChatFeedback()                â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ TAB: AI_Corrections (NEW)                                            â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Purpose: Learned corrections from user feedback                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Columns:                                                             â”‚   â”‚â”‚
â”‚  â”‚  â”‚ A: Timestamp                                                         â”‚   â”‚â”‚
â”‚  â”‚  â”‚ B: Correction Text                                                   â”‚   â”‚â”‚
â”‚  â”‚  â”‚ C: Status (active/disabled)                                          â”‚   â”‚â”‚
â”‚  â”‚  â”‚ D: Category (rate/schedule/terminology/process/other)                â”‚   â”‚â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Populated by: saveCorrection()                                       â”‚   â”‚â”‚
â”‚  â”‚  â”‚ Read by: getRecentCorrections()                                      â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                  â”‚
â”‚  BARCODE SHEET (1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ TAB: Products                                                               â”‚â”‚
â”‚  â”‚ Columns: SKU | Name | Weight | Unit | Price | BarcodeData | Active          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                  â”‚
â”‚  KANBAN SHEET (19UW_tWY6c53lEydXqULAqC3Ffv1C20PDZMKnV6K-byQ)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ TAB: 12.12 Supplies                                                         â”‚â”‚
â”‚  â”‚ Columns: Item | URL | ImageFile | Supplier | OrderWhen | MinQty | MaxQty    â”‚â”‚
â”‚  â”‚          | CurrentQty | Status | Notes                                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## App 1: Ops Hub + AI Agent

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Central dashboard + AI conversational assistant |
| **Frontend** | `ops-hub.html` (~2,300 lines) |
| **Backend** | Production Tracking Code.gs |
| **Sheet ID** | `1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is` |
| **Status** | âœ… Active (v2.0 with AI) |
| **Primary Users** | Boss (mobile), Koa (desktop) |

### File Structure

```
ops-hub.html
â”œâ”€â”€ HTML Structure (lines 1-200)
â”‚   â”œâ”€â”€ App tile grid
â”‚   â”œâ”€â”€ Quick stats panel
â”‚   â””â”€â”€ AI chat widget container
â”‚
â”œâ”€â”€ CSS Styles (lines 200-800)
â”‚   â”œâ”€â”€ CSS variables (brand colors)
â”‚   â”œâ”€â”€ Dark mode styles
â”‚   â”œâ”€â”€ Tile grid layout
â”‚   â”œâ”€â”€ Responsive breakpoints
â”‚   â””â”€â”€ AI chat widget styles
â”‚
â”œâ”€â”€ App Tiles Section (lines 800-1000)
â”‚   â”œâ”€â”€ Scoreboard tile
â”‚   â”œâ”€â”€ SOP Manager tile
â”‚   â”œâ”€â”€ Kanban tile
â”‚   â”œâ”€â”€ Barcode tile
â”‚   â””â”€â”€ Lead Time tile
â”‚
â”œâ”€â”€ AI Chat Widget (lines 1000-1800)
â”‚   â”œâ”€â”€ Chat container HTML
â”‚   â”œâ”€â”€ Message list
â”‚   â”œâ”€â”€ Input area
â”‚   â”œâ”€â”€ Quick action buttons
â”‚   â”œâ”€â”€ Chat JavaScript
â”‚   â”‚   â”œâ”€â”€ sendMessage()
â”‚   â”‚   â”œâ”€â”€ addMessage()
â”‚   â”‚   â”œâ”€â”€ handleFeedback()
â”‚   â”‚   â””â”€â”€ API communication
â”‚   â””â”€â”€ Feedback UI
â”‚
â””â”€â”€ Main Scripts (lines 1800-2300)
    â”œâ”€â”€ loadDashboardData()
    â”œâ”€â”€ updateStats()
    â”œâ”€â”€ Navigation handlers
    â””â”€â”€ Initialization
```

### AI Chat Widget Features

| Feature | Implementation | Status |
|---------|----------------|--------|
| Floating button | ğŸŒ¿ emoji, bottom-right fixed | âœ… |
| Chat panel | Slide-up panel, dark mode | âœ… |
| Message history | Session-based in memory | âœ… |
| Quick actions | 4 preset buttons | âœ… |
| Typing indicator | Animated dots | âœ… |
| Feedback buttons | ğŸ‘/ğŸ‘ per response | âœ… |
| Mobile support | Full-screen on small screens | âœ… |
| Keyboard support | Enter to send | âœ… |

### Quick Action Buttons

| Button | Query Sent |
|--------|------------|
| ğŸ“Š Status | "What's our production status for today?" |
| ğŸ“¦ Bags | "How many bags have we completed today?" |
| âš¡ Rate | "What's our current production rate?" |
| ğŸ‘¥ Crew | "How many people are working right now?" |

---

## App 2: Hourly Production Tracker

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Hour-by-hour production logging, floor display |
| **Frontend** | `scoreboard.html` (~468KB with embedded charts) |
| **Backend** | Production Tracking Code.gs (~1,900 lines) |
| **Sheet ID** | `1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is` |
| **Status** | âœ… Active |
| **Primary Users** | Floor team (TV), supervisors |

### API Endpoints

#### GET Endpoints

| Endpoint | Function | Response |
|----------|----------|----------|
| `?action=scoreboard` | `getScoreboardWithTimerData()` | Full dashboard data |
| `?action=timer` | `getBagTimerData()` | Bag timer only |
| `?action=getScoreboardOrderQueue` | `getScoreboardOrderQueue()` | Order progress data |
| `?action=getOrders` | `getOrders()` | All orders |
| `?action=getOrder&id=X` | `getOrder(id)` | Single order |
| `?action=test` | â€” | `{ ok: true, timestamp }` |
| `?action=dashboard` | `buildDashboardData()` | Complete dashboard |
| (default) | â€” | API info |

#### POST Endpoints

| Endpoint | Function | Body | Response |
|----------|----------|------|----------|
| `?action=chat` | `handleChatRequest()` | `{ message, history }` | AI response |
| `?action=logBag` | `logManualBagCompletion()` | `{ bagType: "5kg" }` | Confirmation |
| `?action=logPause` | `logTimerPause()` | `{ reason, estimatedDuration }` | Pause ID |
| `?action=logResume` | `logTimerResume()` | `{ pauseId, actualDuration }` | Confirmation |
| `?action=setCrewCounts` | `setCrewCounts()` | `{ b1, b2, t1, t2 }` | Confirmation |
| `?action=updateOrderPriority` | `updateOrderPriority()` | `{ orderId, priority }` | Order with new priority |
| `?action=saveOrder` | `saveOrder()` | Order object | Saved order |
| `?action=deleteOrder` | `deleteOrder()` | `{ id }` | `{ success: true }` |

### Data Structures

#### Scoreboard Data Response

```javascript
{
  // Today's production
  todayLbs: 52.3,                    // Total tops produced today
  strain: "Sour Lifter / Sungrown", // Current cultivar
  lastHourLbs: 8.5,                  // Most recent hour's production
  lastTimeSlot: "10:00 AM",         // Which hour that was
  hoursLogged: 4,                    // Hours with data today
  
  // Target tracking
  todayPercentage: 96,               // % of target achieved
  todayTarget: 54.5,                 // Target lbs for logged hours
  projectedTotal: 78.2,              // End-of-day projection
  
  // Crew info
  currentHourTrimmers: 6,            // Trimmers this hour
  lastHourTrimmers: 6,               // Trimmers last hour
  
  // Rate info
  targetRate: 1.07,                  // Expected lbs/trimmer/hour
  strainTargetRate: 1.07,            // Strain-specific rate
  usingStrainRate: true,             // Using strain rate?
  
  // Comparisons
  vsYesterday: 5.2,                  // +/- vs yesterday at this hour
  vs7Day: -2.1,                      // +/- vs 7-day average
  
  // Metadata
  timestamp: "2026-01-02T15:30:00Z"
}
```

#### Bag Timer Data Response

```javascript
{
  // Today's counts
  bags5kgToday: 4,                   // 5kg bags completed today
  bags10lbToday: 2,                  // 10lb bags completed today
  bagsToday: 6,                      // Total bags today
  
  // Cycle times
  avgSecondsToday: 1823,             // Average seconds per bag today
  avgSeconds7Day: 1756,              // 7-day average cycle time
  
  // Last bag info
  lastBagTime: "2026-01-02T15:15:00Z", // When last bag completed
  secondsSinceLastBag: 900,          // Seconds since last bag
  
  // Timer state
  isPaused: false,                   // Is timer currently paused?
  pauseReason: null,                 // Why paused (if paused)
  
  // Metadata
  timestamp: "2026-01-02T15:30:00Z"
}
```

### Key Functions Detail

#### getScoreboardData()

```javascript
/**
 * Get Line 1 production data for the scoreboard
 * 
 * @returns {Object} Production metrics
 * 
 * Data sources:
 * - Current month sheet (YYYY-MM format)
 * - Data sheet (for target rates)
 * - Calculates: totals, rates, comparisons
 * 
 * Logic:
 * 1. Find today's date row in month sheet
 * 2. Sum all Tops column values for today
 * 3. Get current strain from last data row
 * 4. Look up strain-specific target rate
 * 5. Calculate % of target, projections
 * 6. Compare to yesterday/7-day average
 */
function getScoreboardData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var timezone = ss.getSpreadsheetTimeZone();
  // ... implementation
}
```

#### getBagTimerData()

```javascript
/**
 * Get bag completion data from webhook log
 * 
 * @returns {Object} Bag timer metrics
 * 
 * Data sources:
 * - "Rogue Origin Production Tracking" sheet
 * - Timer Pause Log sheet
 * 
 * Logic:
 * 1. Filter webhook log for today's entries
 * 2. Separate 5kg and 10lb bags
 * 3. Calculate time between completions
 * 4. Average excluding outliers/pauses
 * 5. Check if timer currently paused
 */
function getBagTimerData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  // ... implementation
}
```

#### getExtendedDailyDataLine1_(ss, timezone, days)

```javascript
/**
 * Get historical production data for N days
 * 
 * @param {Spreadsheet} ss - Active spreadsheet
 * @param {string} timezone - Spreadsheet timezone
 * @param {number} days - Number of days to retrieve
 * @returns {Array} Daily data objects
 * 
 * Used by: AI Agent for historical analysis
 * 
 * Returns array of:
 * {
 *   date: "2025-12-31",
 *   dayOfWeek: "Tuesday",
 *   topsLbs: 65.4,
 *   smallsLbs: 12.1,
 *   hoursWorked: 7.5,
 *   avgTrimmersPerHour: 6.2,
 *   avgRate: 1.05
 * }
 */
function getExtendedDailyDataLine1_(ss, timezone, days) {
  // ... implementation
}
```

---

## App 3: SOP Manager

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Standard Operating Procedure management |
| **Frontend** | `sop-manager.html` (~1,500 lines) |
| **Backend** | SOP Manager Code.gs |
| **Status** | âœ… Active |
| **Primary Users** | All (reference), Koa (management) |

### Features

| Feature | Description | Status |
|---------|-------------|--------|
| SOP Library | Create, edit, delete SOPs | âœ… |
| Step Management | Drag-and-drop reordering | âœ… |
| Image Annotation | Per-step images | âœ… |
| PDF Export | Multi-page, branded | âœ… |
| Bilingual | EN/ES toggle | âœ… |
| AI Generation | Claude-powered SOP creation | âœ… |
| QR Codes | Link to digital SOP | âœ… |
| Hybrid Cache | localStorage + API sync | âœ… |

### API Endpoints

| Endpoint | Method | Function | Response |
|----------|--------|----------|----------|
| `?action=sops` | GET | `getSOPs()` | Array of all SOPs |
| `?action=sop&id=X` | GET | `getSOP(id)` | Single SOP object |
| `?action=save` | POST | `saveSOP(data)` | Saved SOP |
| `?action=delete` | POST | `deleteSOP(id)` | `{ success: true }` |
| `?action=anthropic` | POST | `proxyAnthropicCall()` | AI response |

### SOP Data Structure

```javascript
{
  id: "sop_12345",
  title: "Scale Calibration",
  titleEs: "CalibraciÃ³n de BÃ¡scula",
  category: "Equipment",
  createdDate: "2025-06-15",
  updatedDate: "2025-12-20",
  author: "Koa",
  version: "1.2",
  steps: [
    {
      stepNumber: 1,
      instruction: "Turn on scale and wait for display",
      instructionEs: "Encienda la bÃ¡scula y espere la pantalla",
      imageUrl: "https://...",
      imageAnnotations: [
        { x: 150, y: 200, label: "Power button" }
      ],
      warnings: ["Ensure scale is on level surface"],
      warningsEs: ["AsegÃºrese de que la bÃ¡scula estÃ© nivelada"]
    },
    // ... more steps
  ],
  qrCode: "https://rogueff.github.io/rogue-origin-apps/sop?id=sop_12345"
}
```

---

## App 4: Kanban Board (Supply Closet Inventory)

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Supply closet inventory management with printable cards |
| **Frontend** | `kanban.html` (~2,100 lines) |
| **Backend** | Kanban Code.gs (~350 lines) |
| **Sheet ID** | `19UW_tWY6c53lEydXqULAqC3Ffv1C20PDZMKnV6K-byQ` |
| **Status** | âœ… Active |
| **Primary Users** | Koa (management), Floor team (viewing) |

### Key Features

| Feature | Description |
|---------|-------------|
| **Supply Cards** | Create cards for each supply item with name, supplier, price, quantity, image |
| **Card Printing** | Print cards with QR codes linking to order URLs |
| **Interactive Tutorial** | 21-step hand-holding tutorial for new users |
| **Auto-fill** | Paste product URL to auto-fetch name, price, and image |
| **Search & Filter** | Find items by name or filter by supplier |
| **Grid/List Views** | Toggle between card grid and list table views |
| **Status Colors** | Green (in stock), Gold (low), Orange (critical) |

### Tutorial System

The Kanban app includes a comprehensive 21-step interactive tutorial:

**Part 1: Page Overview (Steps 1-8)**
- Welcome, header buttons, search/filter, card explanation, action buttons

**Part 2: Create a Card (Steps 9-19)**
- Opens Add Card modal
- Guides through each field: Item Name, Supplier, Quantity, Price, Delivery, Location, URL, Auto-fill, Image
- User actually fills in fields and saves

**Part 3: Print Cards (Steps 20-22)**
- Opens Print modal, select cards, print button, celebration

**Tutorial Elements:**
- Gold graduation cap button (bottom-right) starts tutorial
- Spotlight highlights current element
- Tooltips with tips and encouragement
- Progress dots show completion
- Confetti celebration on finish
- Remembers if user has seen tutorial (localStorage)

### API Endpoints

| Endpoint | Method | Function | Response |
|----------|--------|----------|----------|
| `?action=cards` | GET | `getCards()` | Array of cards |
| `?action=test` | GET | â€” | `{ ok: true }` |
| `?action=add` | POST | `addCard(data)` | New card |
| `?action=update` | POST | `updateCard(data)` | Updated card |
| `?action=delete` | POST | `deleteCard(id)` | `{ success: true }` |
| `?action=fetchProduct` | POST | `fetchProductInfo(url)` | Product data |

### Card Data Structure

```javascript
{
  id: 5,                           // Row number (auto)
  item: "Grove Bags 1lb",          // Item name
  url: "https://grovebags.com/...", // Product URL
  imageFile: "grove_1lb.jpg",      // Image filename
  supplier: "Grove Bags",          // Supplier name
  orderWhen: "Green Card Signal",  // Trigger condition
  minQty: 100,                     // Minimum quantity
  maxQty: 500,                     // Maximum quantity
  currentQty: 250,                 // Current stock
  status: "Green",                 // Red/Yellow/Green
  notes: "Lead time 2 weeks"       // Additional notes
}
```

---

## App 5: Barcode Manager

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Product labels and barcode printing |
| **Frontend** | `barcode.html` (~700 lines) |
| **Backend** | Barcode Manager Code.gs |
| **Sheet ID** | `1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE` |
| **Status** | âœ… Active |
| **Primary Users** | Packaging team |

### Label Specifications

| Property | Value |
|----------|-------|
| Printer | Bixolon thermal |
| Label Size | 1.65" Ã— 0.5" |
| Barcode Format | Code128 |
| Barcode Service | tec-it.com |

### Barcode URL Pattern

```javascript
const barcodeUrl = `https://barcode.tec-it.com/barcode.ashx?` +
  `data=${encodeURIComponent(sku)}` +
  `&code=Code128` +
  `&translate-esc=true` +
  `&dmsize=Default`;
```

### API Endpoints

| Endpoint | Method | Function | Response |
|----------|--------|----------|----------|
| `?action=products` | GET | `getProducts()` | Array of products |
| `?action=test` | GET | â€” | `{ ok: true }` |
| `?action=add` | POST | `addProduct(data)` | New product |
| `?action=update` | POST | `updateProduct(data)` | Updated product |
| `?action=delete` | POST | `deleteProduct(id)` | `{ success: true }` |
| `?action=import` | POST | `importCSV(data)` | Import results |

### Product Data Structure

```javascript
{
  id: 1,                           // Row number
  sku: "RO-LIFT-5KG",              // SKU code
  name: "Lifter 5kg",              // Product name
  weight: 11.02,                   // Weight in lbs
  unit: "lbs",                     // Weight unit
  price: 250.00,                   // Price (optional)
  barcodeData: "RO-LIFT-5KG",      // Barcode content
  active: true                     // Is active product
}
```

---

## App 6: Wholesale Orders System

### Overview

| Property | Value |
|----------|-------|
| **Purpose** | Full CRUD management for wholesale customer orders, shipments, and payments |
| **Frontend** | `src/pages/orders.html` (~1,800 lines) |
| **Backend** | `apps-script/wholesale-orders/Code.gs` (~1,900 lines) |
| **Sheet ID** | `1QLQaR4RMniUmwbJFrtMVaydyVMyCCxqHXWDCVs5dejw` |
| **API URL** | `https://script.google.com/macros/s/AKfycbxU5dBd5GU1RZeJ-UyNFf1Z8n3jCdIZ0VM6nXVj6_A7Pu2VbbxYWXMiDhkkgB3_8L9MyQ/exec` |
| **Status** | âœ… Active (January 2026) |
| **Primary Users** | Koa (management), Sales team |

### Authentication

- Password-protected (server-side validation)
- Password stored in Script Properties: `ORDERS_PASSWORD`
- Session tokens valid for 30 days
- Login required for all operations

### Features

| Feature | Description | Status |
|---------|-------------|--------|
| Customer Management | Create, edit, delete customers | âœ… |
| Order Creation | Master orders with commitment tracking | âœ… |
| Shipment Tracking | Line items with strain, type, quantity, pricing | âœ… |
| Payment Recording | Track payments against orders | âœ… |
| Financial Calculations | Commitment, fulfilled, paid, balance due | âœ… |
| Shopify Import | Import orders from Shopify | âœ… |
| Order Priority | Manual drag-and-drop reordering | âœ… |

### API Endpoints

#### GET Endpoints

| Endpoint | Function | Response |
|----------|----------|----------|
| `?action=getCustomers` | Fetch all customers | Array of customer objects |
| `?action=getMasterOrders` | Fetch all master orders | Array of order objects |
| `?action=getShipments&orderID=X` | Fetch shipments for order | Array of shipment objects |
| `?action=getPayments&orderID=X` | Fetch payments for order | Array of payment objects |
| `?action=getPriceHistory` | Fetch price history | Price history data |
| `?action=validatePassword` | Authentication validation | Session token |
| `?action=test` | Health check | `{ ok: true }` |

#### POST Endpoints

| Endpoint | Function | Body | Response |
|----------|----------|------|----------|
| `?action=saveCustomer` | Create/update customer | Customer object | Saved customer |
| `?action=deleteCustomer` | Delete customer | `{ customerID }` | `{ success: true }` |
| `?action=saveMasterOrder` | Create/update order | Order object | Saved order |
| `?action=deleteMasterOrder` | Delete order | `{ orderID }` | `{ success: true }` |
| `?action=saveShipment` | Create/update shipment | Shipment object | Saved shipment |
| `?action=deleteShipment` | Delete shipment | `{ shipmentID }` | `{ success: true }` |
| `?action=savePayment` | Record payment | Payment object | Saved payment |
| `?action=updateOrderPriority` | Update order priority | `{ orderID, priority }` | Updated order |

### Data Model

**Customers:**
- CustomerID, Company, Contact, Email, Phone
- Ship To Address, Bill To Address
- Country

**MasterOrders:**
- OrderID (format: MO-YYYY-NNN, e.g., MO-2026-003)
- CustomerID, CustomerName
- CommitmentAmount, Currency, Status
- PO Number, Terms (DAP/FOB/EXW)
- Created Date, Due Date
- Ship To/Sold To details (Contact, Company, Address, Phone, Email)
- Notes, Priority

**Shipments:**
- ShipmentID (format: INV-YYYY-NNNN)
- OrderID, Invoice Number
- Shipment Date, Status
- Carrier, Tracking Number
- LineItems (JSON array):
  - Strain, Type (Tops/Smalls), Quantity (kg), Price per Unit, Total
- Dimensions (Length, Width, Height, Weight)
- Financials (Subtotal, Discount, Freight, Total)

**Payments:**
- PaymentID, OrderID
- Payment Date, Amount
- Method (Wire/Check/ACH/etc.)
- Reference Number, Notes

### Security Features

- **Input Validation**: Defined schemas for all data types
- **Formula Injection Prevention**: Blocks `=IMPORTDATA`, `=HYPERLINK`, etc.
- **String Sanitization**: Length limits and special character handling
- **Password Security**: Never stored in code or Git (Script Properties only)
- **Session Management**: 30-day token expiration

### Order ID Generation

Order IDs follow the format `MO-YYYY-NNN`:
- `MO`: Master Order prefix
- `YYYY`: Current year (e.g., 2026)
- `NNN`: Sequential number padded to 3 digits (001, 002, 003...)

**Bug Fix (January 2026):**
- Fixed duplicate Order ID generation issue
- Changed from using `data.length` to finding max existing order number
- Now properly increments: MO-2026-001, MO-2026-002, MO-2026-003

### Google Sheets Structure

**Tab: Customers**
- Columns: CustomerID | Company | Contact | Email | Phone | ShipToAddress | BillToAddress | Country

**Tab: MasterOrders**
- Columns: OrderID | CustomerID | CustomerName | CommitmentAmount | Currency | Status | PONumber | Terms | CreatedDate | DueDate | ShipTo_Contact | ShipTo_Company | ShipTo_Address | ShipTo_Phone | ShipTo_Email | SoldTo_Contact | SoldTo_Company | SoldTo_Address | SoldTo_Phone | SoldTo_Email | Notes | Priority

**Tab: Shipments**
- Columns: ShipmentID | OrderID | InvoiceNumber | ShipmentDate | Status | Carrier | TrackingNumber | LineItems | Dimensions | Subtotal | Discount | Freight | Total | Notes

**Tab: Payments**
- Columns: PaymentID | OrderID | PaymentDate | Amount | Method | Reference | Notes

---

## Data Schemas

### Monthly Production Sheet Schema

| Column | Header | Type | Example | Notes |
|--------|--------|------|---------|-------|
| A | Time Slot | String | "7:00 AM" | Hour label |
| B | Buckers L1 | Number | 2 | Line 1 buckers |
| C | Buckers L2 | Number | 0 | Line 2 buckers |
| D | Trimmers L1 | Number | 6 | Line 1 trimmers |
| E | Trimmers L2 | Number | 0 | Line 2 trimmers |
| F | Cultivar | String | "RO24-047 - Sour Lifter / Sungrown" | Strain |
| G | Tops | Number | 8.5 | Lbs tops produced |
| H | Smalls | Number | 1.2 | Lbs smalls produced |
| I | Wage Rate | Currency | $18.50 | Hourly wage |
| J | Trim Cost | Currency | $9.62 | Calculated cost |

### Bag Completion Log Schema

| Column | Header | Type | Example | Notes |
|--------|--------|------|---------|-------|
| A | Timestamp | DateTime | 2026-01-02T15:30:00Z | ISO format |
| B | Bag Type | String | "5kg" | Size category |
| C | Weight | Number | 11.02 | Actual weight |
| D | SKU | String | "RO-LIFT-5KG" | Product SKU |
| E | Source | String | "webhook" | webhook/manual |

### AI Chat Log Schema

| Column | Header | Type | Example | Notes |
|--------|--------|------|---------|-------|
| A | Timestamp | DateTime | 2026-01-02T15:30:00Z | When asked |
| B | Question | String | "How are we doing?" | User message |
| C | Response | String | "ğŸ“Š We're at 52.3..." | Truncated to 500 chars |
| D | Turn | Number | 3 | Conversation turn |
| E | Feedback | String | "good" | good/bad/null |
| F | Notes | String | "" | Additional context |

### AI Corrections Schema

| Column | Header | Type | Example | Notes |
|--------|--------|------|---------|-------|
| A | Timestamp | DateTime | 2026-01-02T10:00:00Z | When saved |
| B | Correction | String | "We work half days Friday" | Text |
| C | Status | String | "active" | active/disabled |
| D | Category | String | "schedule" | Classification |

---

## API Reference

### Production API Base URL

```
https://script.google.com/macros/s/AKfycbxDAHSFl9cedGS49L3Lf5ztqy-SSToYigyA30ZtsdpmWNAR9H61X_Mm48JOOTGqqr-Z/exec
```

### Request Format

**GET Request:**
```javascript
fetch(`${API_URL}?action=scoreboard`)
  .then(r => r.json())
  .then(data => console.log(data));
```

**POST Request (CORS-safe):**
```javascript
fetch(`${API_URL}?action=chat`, {
  method: 'POST',
  headers: {
    'Content-Type': 'text/plain;charset=utf-8'  // Required for CORS
  },
  body: JSON.stringify({
    message: "How are we doing?",
    history: []
  }),
  redirect: 'follow'
}).then(r => r.json());
```

### Response Format

**Success:**
```json
{
  "success": true,
  "data": { ... },
  "timestamp": "2026-01-02T15:30:00Z"
}
```

**Error:**
```json
{
  "success": false,
  "error": "Error message",
  "timestamp": "2026-01-02T15:30:00Z"
}
```

---

## Shared Utilities

### jsonResponse(data)

```javascript
/**
 * Create JSON response for Apps Script web app
 * @param {Object} data - Data to return
 * @returns {TextOutput} JSON response
 */
function jsonResponse(data) {
  return ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}
```

### getLatestMonthSheet_(ss)

```javascript
/**
 * Find the most recent month sheet (YYYY-MM format)
 * @param {Spreadsheet} ss - Spreadsheet object
 * @returns {Sheet} Month sheet
 */
function getLatestMonthSheet_(ss) {
  var sheets = ss.getSheets();
  var monthPattern = /^\d{4}-\d{2}$/;
  var monthSheets = sheets.filter(s => monthPattern.test(s.getName()));
  monthSheets.sort((a, b) => b.getName().localeCompare(a.getName()));
  return monthSheets[0];
}
```

### getColumnIndices_(headers)

```javascript
/**
 * Map column names to indices
 * @param {Array} headers - Header row values
 * @returns {Object} Column name -> index mapping
 */
function getColumnIndices_(headers) {
  var indices = {};
  for (var i = 0; i < headers.length; i++) {
    var name = String(headers[i]).trim().toLowerCase();
    if (name.includes('trimmer') && name.includes('1')) indices.trimmers1 = i;
    if (name.includes('trimmer') && name.includes('2')) indices.trimmers2 = i;
    if (name.includes('bucker') && name.includes('1')) indices.buckers1 = i;
    if (name.includes('bucker') && name.includes('2')) indices.buckers2 = i;
    if (name.includes('tops') || name === 'tops') indices.tops = i;
    if (name.includes('small')) indices.smalls = i;
    if (name.includes('cultivar') || name.includes('strain')) indices.cultivar = i;
  }
  return indices;
}
```

---

## Integration Points

### Shopify Webhooks

**Event**: Order fulfilled / Bag tagged  
**Target**: Production Tracking Sheet â†’ "Rogue Origin Production Tracking" tab  
**Payload**: Line items with SKU, weight, timestamp

**Setup**:
1. Shopify Admin â†’ Settings â†’ Notifications â†’ Webhooks
2. Add webhook for "Order fulfilled"
3. URL: Apps Script web app URL with `?action=webhook`
4. Format: JSON

### Anthropic Claude API

**Endpoint**: `https://api.anthropic.com/v1/messages`  
**Model**: `claude-sonnet-4-20250514`  
**Key Location**: Script Properties â†’ `ANTHROPIC_API_KEY`

**Request Format**:
```javascript
{
  "model": "claude-sonnet-4-20250514",
  "max_tokens": 1024,
  "system": "System prompt with context...",
  "messages": [
    { "role": "user", "content": "User message" }
  ]
}
```

### tec-it.com Barcode Service

**Endpoint**: `https://barcode.tec-it.com/barcode.ashx`  
**Format**: Code128  
**Free Tier**: Yes, with attribution

**URL Parameters**:
- `data`: Barcode content (URL encoded)
- `code`: Barcode type (Code128)
- `translate-esc`: Enable escape sequences
- `dmsize`: Size (Default)

---

## Changelog

### Version 2.0 (January 2, 2026)

**New Features:**
- âœ… AI Agent integrated into Ops Hub
- âœ… 30-day historical data analysis
- âœ… Per-strain daily breakdown
- âœ… Projection calculations
- âœ… Feedback system (ğŸ‘/ğŸ‘)
- âœ… Correction learning
- âœ… AI_Chat_Log sheet
- âœ… AI_Corrections sheet
- âœ… 10lb bag support

**Functions Added:**
- `handleChatRequest(data)`
- `gatherProductionContext()`
- `gatherHistoricalData(ss, tz)`
- `getDailyStrainBreakdown_(ss, tz, days)`
- `buildSystemPrompt(context, corrections)`
- `callAnthropicForChat(system, history, msg)`
- `extractCorrections(history)`
- `getRecentCorrections()`
- `saveCorrection(text, category)`
- `logChatForTraining(msg, response, turn)`
- `logChatFeedback(feedback)`

### Version 1.5 (December 2025)

- âœ… Added 10lb bag support to bag timer
- âœ… Expanded bag timer data structure

### Version 1.0 (2024)

- âœ… Initial release
- âœ… Hourly Production Tracker
- âœ… Bag Timer (5kg)
- âœ… SOP Manager
- âœ… Kanban Board
- âœ… Barcode Manager
- âœ… Ops Hub Dashboard
