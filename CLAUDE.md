# Rogue Origin Operations Hub - Claude Code Context

> **Last Updated**: January 2, 2026  
> **Version**: 2.0 (AI Agent Release)  
> **Maintainer**: Koa (Operations)  
> **Document Purpose**: Primary context file for Claude Code AI assistance

---

## Table of Contents
1. [Quick Reference](#quick-reference)
2. [Company Overview](#company-overview)
3. [Facility & Operations](#facility--operations)
4. [Application Ecosystem](#application-ecosystem)
5. [AI Agent Complete Reference](#ai-agent-complete-reference)
6. [Standard Code Patterns](#standard-code-patterns)
7. [Key Users & Personas](#key-users--personas)
8. [Project Roadmap](#project-roadmap)
9. [Development Guidelines](#development-guidelines)
10. [Troubleshooting Guide](#troubleshooting-guide)

---

## Quick Reference

### Critical URLs & IDs

| Resource | Value | Notes |
|----------|-------|-------|
| **GitHub Repo** | https://github.com/RogueFF/rogue-origin-apps | Main codebase |
| **Live Apps** | https://rogueff.github.io/rogue-origin-apps/ | GitHub Pages |
| **Production Sheet ID** | `1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is` | Main data |
| **Barcode Sheet ID** | `1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE` | Label data |
| **Production API URL** | `https://script.google.com/macros/s/AKfycbxDAHSFl9cedGS49L3Lf5ztqy-SSToYigyA30ZtsdpmWNAR9H61X_Mm48JOOTGqqr-Z/exec` | Web app |
| **Anthropic API** | `https://api.anthropic.com/v1/messages` | AI endpoint |

### Brand & Styling

| Element | Value | CSS Variable |
|---------|-------|--------------|
| **Primary Green** | `#668971` | `--ro-green` |
| **Dark Green** | `#4a6b54` | `--ro-green-dark` |
| **Light Green** | `#8ba896` | `--ro-green-light` |
| **Gold Accent** | `#e4aa4f` | `--gold` |
| **Danger Red** | `#c45c4a` | `--danger` |
| **Success Green** | `#5a9a6e` | `--success` |
| **Dark BG** | `#1a1a1a` | `--bg-main` |
| **Card BG** | `#2d2d2d` | `--bg-card` |

### AI Configuration

| Setting | Value |
|---------|-------|
| **Model** | `claude-sonnet-4-20250514` |
| **Max Tokens** | 1024 |
| **API Key Location** | Script Properties â†’ `ANTHROPIC_API_KEY` |
| **Context Window** | ~4KB system prompt |

### Git Workflow

**Work directly on `main` branch - no PRs required.**

- Commit and push changes directly to `main`
- Use clear, descriptive commit messages
- No feature branches or pull requests needed
- Changes deploy automatically via GitHub Pages

---

## Company Overview

### About Rogue Origin

**Rogue Origin** is a vertically integrated hemp company based in Southern Oregon (Josephine County). Founded with the vision of becoming the "Toyota of hemp," the company emphasizes data-driven operations and continuous improvement through LEAN/Kaizen methodology.

### Business Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ROGUE ORIGIN BUSINESS MODEL                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  PRODUCTION                    SALES CHANNELS                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ~34 acres    â”‚             â”‚ Direct-to-Consumer (rogueorigin.com) â”‚   â”‚
â”‚  â”‚ hemp fields  â”‚â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â–¶â”‚ - Smokeable flower                   â”‚   â”‚
â”‚  â”‚ (Southern OR)â”‚      â”‚      â”‚ - Pre-rolls                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â”‚ - Accessories                        â”‚   â”‚
â”‚         â”‚              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â–¼              â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Processing   â”‚      â”‚      â”‚ Wholesale (B2B)                      â”‚   â”‚
â”‚  â”‚ Facility     â”‚â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â–¶â”‚ - International freight (EU, etc.)  â”‚   â”‚
â”‚  â”‚ - Drying     â”‚             â”‚ - Bulk flower sales                  â”‚   â”‚
â”‚  â”‚ - Trimming   â”‚             â”‚ - White-label processing             â”‚   â”‚
â”‚  â”‚ - Packaging  â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚         â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚         â”‚                     â”‚ Consignment Partners                 â”‚   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ - Process other farms' hemp          â”‚   â”‚
â”‚                               â”‚ - Revenue share model                â”‚   â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Business Metrics

| Metric | Value | Notes |
|--------|-------|-------|
| Annual Revenue | ~$2M | Varies with market |
| Labor Cost | ~80% of expenses | Primary cost driver |
| Acreage | ~34 acres | Southern Oregon |
| Peak Season Workers | ~50 | Harvest (Sept-Nov) |
| Year-round Workers | ~8-12 | Processing crew |
| Primary Language | Spanish | Production floor |

### Organizational Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THE BOSS (Owner)                          â”‚
â”‚                    - Strategic decisions                     â”‚
â”‚                    - Customer relationships                  â”‚
â”‚                    - Financial oversight                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Operations   â”‚    â”‚    Sales      â”‚    â”‚   Growing     â”‚
â”‚    (Koa)      â”‚    â”‚               â”‚    â”‚               â”‚
â”‚ - Tools/Tech  â”‚    â”‚ - Wholesale   â”‚    â”‚ - Field ops   â”‚
â”‚ - Process     â”‚    â”‚ - Retail      â”‚    â”‚ - Harvest     â”‚
â”‚ - Data        â”‚    â”‚ - Partners    â”‚    â”‚ - Irrigation  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PRODUCTION FLOOR TEAM                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚Trimmers â”‚  â”‚ Buckers â”‚  â”‚   QC    â”‚  â”‚Packagingâ”‚      â”‚
â”‚  â”‚ (6-10)  â”‚  â”‚  (2-4)  â”‚  â”‚  (1-2)  â”‚  â”‚  (1-2)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                            â”‚
â”‚  Language: Predominantly Spanish                           â”‚
â”‚  Supervision: Floor lead (bilingual)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Facility & Operations

### Facility Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PROCESSING FACILITY                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚   INTAKE AREA    â”‚        â”‚   DRYING ROOM    â”‚                       â”‚
â”‚  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                       â”‚
â”‚  â”‚ - Weigh station  â”‚        â”‚ - Temp/humidity  â”‚                       â”‚
â”‚  â”‚ - QC check       â”‚        â”‚   controlled     â”‚                       â”‚
â”‚  â”‚ - Lot tagging    â”‚        â”‚ - Hang dry racks â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                       â”‚                                  â”‚
â”‚                                       â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         TRIM ROOM (Main Floor)                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚ â”‚
â”‚  â”‚  â”‚   LINE 1    â”‚  â”‚   LINE 2    â”‚  â”‚  BUCKING    â”‚                 â”‚ â”‚
â”‚  â”‚  â”‚ (Primary)   â”‚  â”‚ (Overflow)  â”‚  â”‚  STATION    â”‚                 â”‚ â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚                 â”‚ â”‚
â”‚  â”‚  â”‚ 6-8 seats   â”‚  â”‚ 4-6 seats   â”‚  â”‚ 2-4 people  â”‚                 â”‚ â”‚
â”‚  â”‚  â”‚ Hand trim   â”‚  â”‚ Hand trim   â”‚  â”‚ De-stemming â”‚                 â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  T-ZERO     â”‚         â”‚  FLOOR TV DISPLAY                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  MACHINE    â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚             â”‚         â”‚  â”‚ Today: 52.3 lbs | 96% target  â”‚  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Twister     â”‚         â”‚  â”‚ Rate: 1.07 lbs/hr | Crew: 6   â”‚  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ T-Zero      â”‚         â”‚  â”‚ Strain: Sour Lifter           â”‚  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚ â”‚
â”‚  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚                                  â”‚
â”‚                                       â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  PACKAGING AREA  â”‚        â”‚   STORAGE/       â”‚                       â”‚
â”‚  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   FULFILLMENT    â”‚                       â”‚
â”‚  â”‚ - Grove Bags     â”‚        â”‚                  â”‚                       â”‚
â”‚  â”‚ - Heat sealer    â”‚        â”‚ - Pallet racks   â”‚                       â”‚
â”‚  â”‚ - Label printer  â”‚        â”‚ - SKU locations  â”‚                       â”‚
â”‚  â”‚ - Scale          â”‚        â”‚ - Shipping prep  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Work Schedule

| Time | Activity |
|------|----------|
| 7:00 AM | Shift start, setup |
| 7:00-9:00 AM | Production block 1 |
| 9:00-9:10 AM | Break (10 min) |
| 9:10-12:00 PM | Production block 2 |
| 12:00-12:30 PM | Lunch (30 min) |
| 12:30-2:30 PM | Production block 3 |
| 2:30-2:40 PM | Break (10 min) |
| 2:40-4:20 PM | Production block 4 |
| 4:20-4:30 PM | Cleanup (10 min) |
| 4:30 PM | Shift end |

**Effective work hours**: ~7.5 hours/day (8.5 total - 1 hour breaks)

### Strain/Cultivar Reference

| Strain | Type | Trim Rate | Notes |
|--------|------|-----------|-------|
| Sour Lifter | Sungrown | 1.07 lbs/hr | Main production strain |
| Lifter | Sungrown | 1.05 lbs/hr | Popular, good structure |
| Cherry Wine | Indoor | 0.85 lbs/hr | Denser, slower trim |
| Special Sauce | Sungrown | 1.00 lbs/hr | Standard rate |
| Hawaiian Haze | Sungrown | 0.95 lbs/hr | Looser structure |
| Elektra | Sungrown | 1.02 lbs/hr | Good production strain |

**Note**: Strain names in data often formatted as "LOT# - StrainName / Type" (e.g., "RO24-047 - Sour Lifter / Sungrown")

### Bag Types & Packaging

| Bag Type | Weight | Use Case | Packaging |
|----------|--------|----------|-----------|
| 5kg bag | 11.02 lbs | Primary wholesale | Grove Bags |
| 10lb tops | 10.0 lbs | Secondary wholesale | Grove Bags |
| 1lb bag | 1.0 lb | Smaller orders | Grove Bags |
| 1/4lb bag | 0.25 lb | Retail | Grove Bags |
| 1oz bag | 0.0625 lb | Retail | Grove Bags |

### Equipment

| Equipment | Brand/Model | Purpose |
|-----------|-------------|---------|
| Trim Machine | Twister T-Zero | Initial machine trim |
| Heat Sealer | â€” | Bag sealing |
| Label Printer | Bixolon thermal | Barcode labels |
| Scale (primary) | â€” | Production weighing |
| Scale (packaging) | â€” | Final weight verification |
| Pallet Trackers | TIVE | Shipment tracking |

### Key Terminology

| Term | Meaning |
|------|---------|
| **Tops** | Premium flower buds (main product) |
| **Smalls** | Smaller buds, lower grade |
| **Trim** | Leaf material trimmed from buds |
| **Bucking** | Removing buds from stems |
| **Hand touch** | Manual finishing after machine trim |
| **Supersack** | 30lb bulk storage bag |
| **Grove Bags** | Brand of packaging bags |
| **COA** | Certificate of Analysis (lab test) |
| **Lot number** | Batch identifier (e.g., RO24-047) |
| **Line 1 / Line 2** | Production lines in trim room |
| **The floor** | Production/trim room |

---

## Application Ecosystem

### Complete App Inventory

| # | App | Frontend | Backend | Sheet | Status | Primary Users |
|---|-----|----------|---------|-------|--------|---------------|
| 1 | **Ops Hub** | index.html | Production Code.gs | Production | âœ… Active | All |
| 2 | **AI Agent** | (in Ops Hub) | Production Code.gs | Production | âœ… Active | Boss, Koa |
| 3 | **Scoreboard** | scoreboard.html | Production Code.gs | Production | âœ… Active | Floor team |
| 4 | **SOP Manager** | sop-manager.html | SOP Code.gs | SOP | âœ… Active | All |
| 5 | **Kanban** | kanban.html | Kanban Code.gs | Kanban | âœ… Active | Koa |
| 6 | **Barcode Manager** | barcode.html | Barcode Code.gs | Barcode | âœ… Active | Packaging |
| 7 | **Order Management** | orders.html | (pending) | Orders | âœ… Active | Sales, Koa |
| 8 | **Customer Portal** | order.html | (pending) | Orders | âœ… Active | Customers |

### System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USER LAYER                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ğŸ‘” BOSS (Mobile)          ğŸ‘· FLOOR (Tablet/TV)        ğŸ› ï¸ KOA (Desktop)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ AI Chat       â”‚       â”‚ â€¢ Scoreboard    â”‚       â”‚ â€¢ All apps      â”‚    â”‚
â”‚  â”‚ â€¢ Quick status  â”‚       â”‚ â€¢ Crew sidebar  â”‚       â”‚ â€¢ Claude Code   â”‚    â”‚
â”‚  â”‚ â€¢ Voice (future)â”‚       â”‚ â€¢ SOP lookup    â”‚       â”‚ â€¢ Apps Script   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â”‚                         â”‚                         â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                         â”‚                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            FRONTEND LAYER                                    â”‚
â”‚                  GitHub Pages (rogueff.github.io/rogue-origin-apps/)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ops-hub     â”‚ â”‚ scoreboard  â”‚ â”‚ sop-manager â”‚ â”‚ kanban      â”‚ â”‚barcode â”‚ â”‚
â”‚  â”‚ .html       â”‚ â”‚ .html       â”‚ â”‚ .html       â”‚ â”‚ .html       â”‚ â”‚.html   â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚        â”‚ â”‚
â”‚  â”‚ 2,300 lines â”‚ â”‚ 800 lines   â”‚ â”‚ 1,500 lines â”‚ â”‚ 600 lines   â”‚ â”‚700 ln  â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚        â”‚ â”‚
â”‚  â”‚ Features:   â”‚ â”‚ Features:   â”‚ â”‚ Features:   â”‚ â”‚ Features:   â”‚ â”‚Feats:  â”‚ â”‚
â”‚  â”‚ â€¢ Dashboard â”‚ â”‚ â€¢ TV displayâ”‚ â”‚ â€¢ CRUD SOPs â”‚ â”‚ â€¢ Columns   â”‚ â”‚â€¢ SKUs  â”‚ â”‚
â”‚  â”‚ â€¢ AI Chat   â”‚ â”‚ â€¢ Charts    â”‚ â”‚ â€¢ Drag/drop â”‚ â”‚ â€¢ Drag/drop â”‚ â”‚â€¢ Print â”‚ â”‚
â”‚  â”‚ â€¢ App tiles â”‚ â”‚ â€¢ Auto-ref  â”‚ â”‚ â€¢ PDF exportâ”‚ â”‚ â€¢ Filters   â”‚ â”‚â€¢ Importâ”‚ â”‚
â”‚  â”‚ â€¢ Dark mode â”‚ â”‚ â€¢ Bilingual â”‚ â”‚ â€¢ Bilingual â”‚ â”‚ â€¢ Archive   â”‚ â”‚        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚               â”‚               â”‚               â”‚            â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚               â”‚               â”‚            â”‚
          â”‚ fetch()       â”‚ fetch()       â”‚ fetch()       â”‚ fetch()    â”‚ fetch()
          â”‚ (text/plain)  â”‚ (GET)         â”‚ (POST/GET)    â”‚ (POST/GET) â”‚ (P/G)
          â”‚               â”‚               â”‚               â”‚            â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            BACKEND LAYER                                     â”‚
â”‚                     Google Apps Script Web Apps                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ PRODUCTION TRACKING (Code.gs) - ~1,900 lines                            â”‚â”‚
â”‚  â”‚ Sheet: 1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is                      â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚â”‚
â”‚  â”‚ â”‚ API Routing      â”‚ â”‚ Scoreboard       â”‚ â”‚ Bag Timer        â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ doGet(e)       â”‚ â”‚ â€¢ getScoreboard  â”‚ â”‚ â€¢ getBagTimer    â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ doPost(e)      â”‚ â”‚   Data()         â”‚ â”‚   Data()         â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ jsonResponse() â”‚ â”‚ â€¢ getLine2Data() â”‚ â”‚ â€¢ logManualBag() â”‚          â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚â”‚
â”‚  â”‚ â”‚ AI Agent         â”‚ â”‚ Historical       â”‚ â”‚ Crew Management  â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ handleChat     â”‚ â”‚ â€¢ getExtended    â”‚ â”‚ â€¢ setCrewCounts()â”‚          â”‚â”‚
â”‚  â”‚ â”‚   Request()      â”‚ â”‚   DailyData()    â”‚ â”‚ â€¢ getCurrentCrew â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ gatherContext()â”‚ â”‚ â€¢ getDailyStrain â”‚ â”‚   Counts()       â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ buildPrompt()  â”‚ â”‚   Breakdown()    â”‚ â”‚ â€¢ logCrewChange()â”‚          â”‚â”‚
â”‚  â”‚ â”‚ â€¢ callAnthropic()â”‚ â”‚ â€¢ gatherHistory()â”‚ â”‚                  â”‚          â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚â”‚
â”‚  â”‚          â”‚                                                               â”‚â”‚
â”‚  â”‚          â–¼                                                               â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚â”‚
â”‚  â”‚ â”‚ ANTHROPIC API    â”‚                                                    â”‚â”‚
â”‚  â”‚ â”‚ claude-sonnet-4-20250514  â”‚                                                    â”‚â”‚
â”‚  â”‚ â”‚ External call    â”‚                                                    â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ SOP MANAGER (Code.gs)  â”‚ â”‚ KANBAN (Code.gs)       â”‚                      â”‚
â”‚  â”‚ â€¢ getSOPs()            â”‚ â”‚ â€¢ getCards()           â”‚                      â”‚
â”‚  â”‚ â€¢ saveSOP()            â”‚ â”‚ â€¢ addCard()            â”‚                      â”‚
â”‚  â”‚ â€¢ deleteSOP()          â”‚ â”‚ â€¢ updateCard()         â”‚                      â”‚
â”‚  â”‚ â€¢ proxyAnthropic()     â”‚ â”‚ â€¢ moveCard()           â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BARCODE MANAGER (Code.gs)                                              â”‚ â”‚
â”‚  â”‚ Sheet: 1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE                     â”‚ â”‚
â”‚  â”‚ â€¢ getProducts() â€¢ addProduct() â€¢ updateProduct() â€¢ importCSV()         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             DATA LAYER                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ PRODUCTION SHEET                                                         â”‚â”‚
â”‚  â”‚ ID: 1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is                         â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ Tabs:                                                                    â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚
â”‚  â”‚ â”‚ 2026-01        â”‚ â”‚ 2025-12        â”‚ â”‚ 2025-11        â”‚ ...            â”‚â”‚
â”‚  â”‚ â”‚ (Current month)â”‚ â”‚ (Last month)   â”‚ â”‚ (Archive)      â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Daily hour-by- â”‚ â”‚                â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â”‚ hour productionâ”‚ â”‚                â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚
â”‚  â”‚ â”‚ Rogue Origin   â”‚ â”‚ Timer Pause    â”‚ â”‚ CrewChangeLog  â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Production     â”‚ â”‚ Log            â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Tracking       â”‚ â”‚                â”‚ â”‚ Timestamp,     â”‚                â”‚â”‚
â”‚  â”‚ â”‚                â”‚ â”‚ Timestamp,     â”‚ â”‚ Before, After, â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Shopify webhookâ”‚ â”‚ Reason,        â”‚ â”‚ Reason, User   â”‚                â”‚â”‚
â”‚  â”‚ â”‚ bag completionsâ”‚ â”‚ Duration       â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚
â”‚  â”‚ â”‚ Data           â”‚ â”‚ Master         â”‚ â”‚ AI_Chat_Log    â”‚                â”‚â”‚
â”‚  â”‚ â”‚                â”‚ â”‚                â”‚ â”‚ (NEW)          â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Cultivars,     â”‚ â”‚ Auto-generated â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Wage rates,    â”‚ â”‚ consolidation  â”‚ â”‚ Timestamp,     â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Target rates   â”‚ â”‚ of all months  â”‚ â”‚ Question,      â”‚                â”‚â”‚
â”‚  â”‚ â”‚                â”‚ â”‚                â”‚ â”‚ Response,      â”‚                â”‚â”‚
â”‚  â”‚ â”‚                â”‚ â”‚                â”‚ â”‚ Feedback       â”‚                â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                      â”‚â”‚
â”‚  â”‚ â”‚ AI_Corrections â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚ (NEW)          â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚                â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚ Timestamp,     â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚ Correction,    â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚ Status,        â”‚                                                      â”‚â”‚
â”‚  â”‚ â”‚ Category       â”‚                                                      â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ EXTERNAL INTEGRATIONS                                                    â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚â”‚
â”‚  â”‚ â”‚ Shopify        â”‚ â”‚ Anthropic      â”‚ â”‚ tec-it.com     â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Webhooks       â”‚ â”‚ Claude API     â”‚ â”‚ Barcode Serviceâ”‚                â”‚â”‚
â”‚  â”‚ â”‚                â”‚ â”‚                â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â”‚ Triggers on    â”‚ â”‚ AI chat        â”‚ â”‚ Code128 barcodeâ”‚                â”‚â”‚
â”‚  â”‚ â”‚ bag completion â”‚ â”‚ responses      â”‚ â”‚ image generatorâ”‚                â”‚â”‚
â”‚  â”‚ â”‚ in fulfillment â”‚ â”‚                â”‚ â”‚                â”‚                â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## AI Agent Complete Reference

### Overview

The AI Agent is a conversational assistant embedded in the Ops Hub dashboard. It provides instant answers to production questions by querying real-time and historical data.

### Access Points

| Method | Location | Notes |
|--------|----------|-------|
| Chat Widget | ops-hub.html | Floating ğŸŒ¿ button, bottom-right |
| Quick Actions | Chat panel | Pre-built query buttons |
| API Direct | `POST ?action=chat` | For integration |

### Capabilities Matrix

| Category | Capability | Data Source | Example Query |
|----------|------------|-------------|---------------|
| **Real-time Status** | Today's production | getScoreboardData() | "How are we doing today?" |
| **Real-time Status** | Current rate | getScoreboardData() | "What's our current rate?" |
| **Real-time Status** | Crew count | getScoreboardData() | "How many people working?" |
| **Real-time Status** | Current strain | getScoreboardData() | "What strain are we on?" |
| **Real-time Status** | Target progress | getScoreboardData() | "Are we on track?" |
| **Bag Tracking** | Today's bags | getBagTimerData() | "How many bags completed?" |
| **Bag Tracking** | Cycle time | getBagTimerData() | "Average bag cycle time?" |
| **Bag Tracking** | Last bag | getBagTimerData() | "When was the last bag?" |
| **Bag Tracking** | By type | getBagTimerData() | "How many 5kg vs 10lb?" |
| **Historical** | Day comparison | gatherHistoricalData() | "Compare to yesterday" |
| **Historical** | Week comparison | gatherHistoricalData() | "This week vs last week?" |
| **Historical** | 30-day summary | gatherHistoricalData() | "Best day this month?" |
| **Historical** | Strain by day | getDailyStrainBreakdown_() | "Lifter tops on Tuesday?" |
| **Historical** | Strain performance | strainSummary | "Fastest trimming strain?" |
| **Projections** | Time estimate | Formula calculation | "How long for 40kg?" |
| **Projections** | Crew planning | Formula calculation | "Trimmers for Friday noon?" |
| **Projections** | End of day | projectedTotal | "Will we hit 80 lbs today?" |

### API Specification

**Endpoint**: `POST /exec?action=chat`

**Request Headers**:
```
Content-Type: text/plain;charset=utf-8
```

**Request Body**:
```json
{
  "action": "chat",
  "message": "How are we doing today?",
  "history": [
    {
      "role": "user",
      "content": "Previous question"
    },
    {
      "role": "assistant", 
      "content": "Previous response"
    }
  ]
}
```

**Response**:
```json
{
  "success": true,
  "response": "ğŸ“Š We're at 52.3 lbs today (96% of target)...",
  "context": {
    "timestamp": "2026-01-02T15:30:00Z",
    "production": {
      "topsToday": 52.3,
      "strain": "Sour Lifter / Sungrown",
      "lastHourLbs": 8.5,
      "lastTimeSlot": "2:00 PM",
      "hoursLogged": 6,
      "todayPercentage": 96,
      "todayTarget": 54.5,
      "projectedTotal": 78.2
    },
    "bags": {
      "fiveKgToday": 4,
      "tenLbToday": 2,
      "totalToday": 6,
      "avgCycleSeconds": 1823,
      "avgCycle7Day": 1756,
      "lastBagTime": "2026-01-02T15:15:00Z",
      "secondsSinceLastBag": 900
    },
    "crew": {
      "currentTrimmers": 6,
      "lastHourTrimmers": 6
    },
    "rates": {
      "targetRate": 1.07,
      "strainTargetRate": 1.07,
      "usingStrainRate": true,
      "vsYesterday": 5.2,
      "vs7Day": -2.1
    },
    "history": {
      "last7Days": [...],
      "last30Days": {...},
      "weekOverWeek": {...},
      "strainSummary": [...],
      "dailyStrainBreakdown": [...]
    }
  }
}
```

**Feedback Request**:
```json
{
  "feedback": {
    "question": "How are we doing today?",
    "rating": "good",
    "timestamp": "2026-01-02T15:30:00Z",
    "note": "Optional correction note"
  }
}
```

### Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AI AGENT DATA FLOW                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Message: "How many Lifter tops did we do on Tuesday?"
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           handleChatRequest(data)                            â”‚
â”‚                                                                              â”‚
â”‚  1. Parse user message                                                       â”‚
â”‚  2. Extract conversation history                                             â”‚
â”‚  3. Check for feedback (if present, log and return)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
                    â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gatherProduction    â”‚ â”‚ extractCorrections  â”‚ â”‚ getRecentCorrectionsâ”‚
â”‚ Context()           â”‚ â”‚ (history)           â”‚ â”‚ ()                  â”‚
â”‚                     â”‚ â”‚                     â”‚ â”‚                     â”‚
â”‚ Calls:              â”‚ â”‚ Looks for:          â”‚ â”‚ Loads from:         â”‚
â”‚ â€¢ getScoreboardData â”‚ â”‚ â€¢ "Actually..."     â”‚ â”‚ AI_Corrections      â”‚
â”‚ â€¢ getBagTimerData   â”‚ â”‚ â€¢ "No, ..."         â”‚ â”‚ sheet               â”‚
â”‚ â€¢ gatherHistorical  â”‚ â”‚ â€¢ "Remember:"       â”‚ â”‚                     â”‚
â”‚   Data              â”‚ â”‚ â€¢ "FYI:"            â”‚ â”‚ Returns last 20     â”‚
â”‚                     â”‚ â”‚ â€¢ "We usually..."   â”‚ â”‚ active corrections  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                       â”‚                       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    gatherHistoricalData(ss, timezone)                        â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ getExtendedDaily    â”‚  â”‚ getDailyStrain      â”‚  â”‚ Calculate:          â”‚  â”‚
â”‚  â”‚ DataLine1_(30 days) â”‚  â”‚ Breakdown_(14 days) â”‚  â”‚ â€¢ weekOverWeek      â”‚  â”‚
â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚ â€¢ strainSummary     â”‚  â”‚
â”‚  â”‚ Returns:            â”‚  â”‚ Returns:            â”‚  â”‚ â€¢ best/worst days   â”‚  â”‚
â”‚  â”‚ â€¢ Daily totals      â”‚  â”‚ â€¢ Per-day strains   â”‚  â”‚                     â”‚  â”‚
â”‚  â”‚ â€¢ Hours worked      â”‚  â”‚ â€¢ Tops per strain   â”‚  â”‚                     â”‚  â”‚
â”‚  â”‚ â€¢ Avg rates         â”‚  â”‚ â€¢ Smalls per strain â”‚  â”‚                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              buildSystemPrompt(context, sessionCorrections)                  â”‚
â”‚                                                                              â”‚
â”‚  Constructs ~4KB system prompt containing:                                   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ CURRENT TIME: Thursday, January 02, 2026 3:30 PM                        â”‚â”‚
â”‚  â”‚ â€¢ Hours remaining today: 1.0 effective hours                            â”‚â”‚
â”‚  â”‚ â€¢ Work days remaining this week: 3 (Mon-Fri)                            â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ TODAY'S PRODUCTION                                                       â”‚â”‚
â”‚  â”‚ â€¢ Tops produced: 52.3 lbs                                                â”‚â”‚
â”‚  â”‚ â€¢ Target: 54.5 lbs                                                       â”‚â”‚
â”‚  â”‚ â€¢ Performance: 96%                                                       â”‚â”‚
â”‚  â”‚ â€¢ Projected end-of-day: 78.2 lbs                                        â”‚â”‚
â”‚  â”‚ â€¢ Current strain: Sour Lifter / Sungrown                                â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ CREW: 6 trimmers                                                        â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ BAGS TODAY: 4 Ã— 5kg, 2 Ã— 10lb                                           â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ HISTORICAL DATA (Last 30 Days)                                          â”‚â”‚
â”‚  â”‚ â€¢ Total: 1,247.3 lbs over 18 days                                       â”‚â”‚
â”‚  â”‚ â€¢ Daily average: 69.3 lbs                                               â”‚â”‚
â”‚  â”‚ â€¢ Best day: Dec 15 (92.1 lbs)                                           â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ WEEK OVER WEEK: This week 312.4 lbs vs last week 298.7 lbs (+4.6%)      â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ DETAILED DAILY STRAIN BREAKDOWN (Last 14 Days)                          â”‚â”‚
â”‚  â”‚ Tuesday (December 31, 2024):                                            â”‚â”‚
â”‚  â”‚   â€¢ Sour Lifter: 45.2 lbs tops, 8.3 lbs smalls                         â”‚â”‚
â”‚  â”‚   â€¢ Cherry Wine: 12.1 lbs tops                                          â”‚â”‚
â”‚  â”‚ ...                                                                      â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ LEARNED CORRECTIONS                                                      â”‚â”‚
â”‚  â”‚ â€¢ We only work half days on Fridays (7am-noon)                          â”‚â”‚
â”‚  â”‚ â€¢ Boss prefers kg over lbs                                              â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ PROJECTION FORMULAS                                                      â”‚â”‚
â”‚  â”‚ â€¢ 1 kg = 2.205 lbs                                                      â”‚â”‚
â”‚  â”‚ â€¢ Hours needed = lbs Ã· (trimmers Ã— rate)                                â”‚â”‚
â”‚  â”‚ â€¢ Effective hours/day = 7.5                                             â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚ RESPONSE GUIDELINES                                                      â”‚â”‚
â”‚  â”‚ 1. Be concise - boss reads on phone                                     â”‚â”‚
â”‚  â”‚ 2. Lead with the most important insight                                 â”‚â”‚
â”‚  â”‚ 3. Use emojis sparingly (ğŸ“Š ğŸ“¦ ğŸ‘¥ âš¡ ğŸ“ˆ ğŸ“‰)                               â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 callAnthropicForChat(systemPrompt, history, message)         â”‚
â”‚                                                                              â”‚
â”‚  POST https://api.anthropic.com/v1/messages                                  â”‚
â”‚  Headers:                                                                    â”‚
â”‚    Content-Type: application/json                                            â”‚
â”‚    x-api-key: [ANTHROPIC_API_KEY from Script Properties]                     â”‚
â”‚    anthropic-version: 2023-06-01                                             â”‚
â”‚                                                                              â”‚
â”‚  Body:                                                                       â”‚
â”‚  {                                                                           â”‚
â”‚    "model": "claude-sonnet-4-20250514",                                              â”‚
â”‚    "max_tokens": 1024,                                                       â”‚
â”‚    "system": "[4KB system prompt]",                                          â”‚
â”‚    "messages": [                                                             â”‚
â”‚      ...last 10 history messages...,                                         â”‚
â”‚      { "role": "user", "content": "How many Lifter tops on Tuesday?" }       â”‚
â”‚    ]                                                                         â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AI Response                                     â”‚
â”‚                                                                              â”‚
â”‚  "On Tuesday (December 31), you did 45.2 lbs of Lifter tops.                â”‚
â”‚                                                                              â”‚
â”‚   That was alongside 8.3 lbs of Lifter smalls and 12.1 lbs of Cherry Wine   â”‚
â”‚   tops for a total of 65.6 lbs that day."                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        logChatForTraining()                                  â”‚
â”‚                                                                              â”‚
â”‚  Appends to AI_Chat_Log sheet:                                               â”‚
â”‚  | Timestamp | Question | Response | Turn | Feedback | Notes |              â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                          Return to User
```

### Correction Detection Patterns

The AI detects corrections using these regex patterns:

| Pattern | Example | Match |
|---------|---------|-------|
| `/^actually[,:]?\s+(.+)/i` | "Actually, we work half days Friday" | âœ“ |
| `/^no[,:]?\s+(.+)/i` | "No, the rate is lower than that" | âœ“ |
| `/^that'?s (?:wrong\|incorrect)/i` | "That's wrong, it should be..." | âœ“ |
| `/^correction[,:]?\s+(.+)/i` | "Correction: we use kg not lbs" | âœ“ |
| `/^fyi[,:]?\s+(.+)/i` | "FYI we call it the floor" | âœ“ |
| `/^remember[,:]?\s+(.+)/i` | "Remember: boss prefers kg" | âœ“ |
| `/^note[,:]?\s+(.+)/i` | "Note: Friday is half day" | âœ“ |
| `/^we (?:actually\|usually)/i` | "We usually start at 7am" | âœ“ |
| `/^it'?s actually\s+(.+)/i` | "It's actually 7.5 hours" | âœ“ |

### Projection Formulas

The AI uses these formulas for time/crew calculations:

**Conversions**:
- 1 kg = 2.205 lbs
- 5 kg bag = 11.02 lbs
- 10 lb bag = 10 lbs

**Time Calculations**:
```
Lbs per hour = trimmers Ã— rate (lbs/trimmer/hour)
Hours needed = target lbs Ã· (trimmers Ã— rate)
Days needed = hours needed Ã· 7.5 effective hours/day
```

**Crew Calculations**:
```
Trimmers needed = target lbs Ã· (hours available Ã— rate)
```

**Example**: "How long for 40kg of Lifter with 5 trimmers?"
```
40 kg Ã— 2.205 = 88.2 lbs
Lifter rate = 1.07 lbs/trimmer/hour
88.2 Ã· (5 Ã— 1.07) = 16.5 hours
16.5 Ã· 7.5 = 2.2 work days
```

---

## Standard Code Patterns

### 1. Dual-Mode Environment Detection

```javascript
/**
 * Detect if running in Apps Script bound mode or GitHub Pages
 * This pattern must be used in ALL frontend files
 */
const isAppsScript = typeof google !== 'undefined' && google.script;
const API_URL = 'https://script.google.com/macros/s/AKfycbxDAHSFl9cedGS49L3Lf5ztqy-SSToYigyA30ZtsdpmWNAR9H61X_Mm48JOOTGqqr-Z/exec';

/**
 * Universal data loader that works in both environments
 */
async function loadData(action, params = {}) {
  if (isAppsScript) {
    // Apps Script bound mode - use google.script.run
    return new Promise((resolve, reject) => {
      google.script.run
        .withSuccessHandler(resolve)
        .withFailureHandler(reject)
        .getData(action, params);
    });
  } else {
    // GitHub Pages mode - use fetch API
    const queryString = new URLSearchParams({ action, ...params }).toString();
    const response = await fetch(`${API_URL}?${queryString}`);
    return response.json();
  }
}
```

### 2. CORS-Safe POST Requests

```javascript
/**
 * POST data to Apps Script from GitHub Pages
 * MUST use text/plain to avoid CORS preflight
 */
async function postData(action, data) {
  const response = await fetch(`${API_URL}?action=${action}`, {
    method: 'POST',
    headers: {
      // CRITICAL: Use text/plain, NOT application/json
      // application/json triggers CORS preflight which Apps Script blocks
      'Content-Type': 'text/plain;charset=utf-8'
    },
    body: JSON.stringify(data),
    redirect: 'follow'  // Handle Apps Script redirects
  });
  
  return response.json();
}
```

### 3. Apps Script Web App Handler

```javascript
/**
 * Standard doGet handler for Apps Script web apps
 */
function doGet(e) {
  var action = (e && e.parameter && e.parameter.action) || '';
  var result;
  
  try {
    switch(action) {
      case 'scoreboard':
        result = getScoreboardWithTimerData();
        break;
      case 'timer':
        result = getBagTimerData();
        break;
      case 'test':
        result = { 
          ok: true, 
          timestamp: new Date().toISOString(),
          message: 'API is working'
        };
        break;
      default:
        result = { 
          message: 'Rogue Origin API ready',
          availableActions: ['scoreboard', 'timer', 'test']
        };
    }
  } catch (error) {
    result = { error: error.message };
  }
  
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}

/**
 * Standard doPost handler for Apps Script web apps
 */
function doPost(e) {
  var action = (e && e.parameter && e.parameter.action) || '';
  var data = {};
  
  try {
    // Parse POST body (works with text/plain content type)
    if (e.postData && e.postData.contents) {
      data = JSON.parse(e.postData.contents);
    }
  } catch (parseError) {
    return ContentService.createTextOutput(JSON.stringify({
      error: 'Invalid JSON in request body'
    })).setMimeType(ContentService.MimeType.JSON);
  }
  
  var result;
  
  try {
    switch(action) {
      case 'chat':
        result = handleChatRequest(data);
        break;
      case 'logBag':
        result = logManualBagCompletion(data.bagType || '5kg');
        break;
      case 'logPause':
        result = logTimerPause(data.reason || '');
        break;
      case 'logResume':
        result = logTimerResume();
        break;
      case 'setCrewCounts':
        result = setCrewCounts(data);
        break;
      default:
        result = { error: 'Unknown action: ' + action };
    }
  } catch (error) {
    result = { error: error.message };
  }
  
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}

/**
 * Helper function for JSON responses
 */
function jsonResponse(data) {
  return ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}
```

### 4. Bilingual Support (Required for All UI)

```javascript
/**
 * Translation labels - EVERY user-facing string must be here
 */
const labels = {
  en: {
    // Common actions
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    edit: 'Edit',
    close: 'Close',
    loading: 'Loading...',
    error: 'Error',
    success: 'Success',
    
    // Production terms
    trimmers: 'Trimmers',
    buckers: 'Buckers',
    tops: 'Tops',
    smalls: 'Smalls',
    bags: 'Bags',
    rate: 'Rate',
    target: 'Target',
    actual: 'Actual',
    
    // Time
    today: 'Today',
    yesterday: 'Yesterday',
    thisWeek: 'This Week',
    lastWeek: 'Last Week',
    
    // Status
    onTrack: 'On Track',
    behind: 'Behind',
    ahead: 'Ahead'
  },
  es: {
    // Common actions
    save: 'Guardar',
    cancel: 'Cancelar',
    delete: 'Eliminar',
    edit: 'Editar',
    close: 'Cerrar',
    loading: 'Cargando...',
    error: 'Error',
    success: 'Ã‰xito',
    
    // Production terms
    trimmers: 'Podadores',
    buckers: 'Deshojadores',
    tops: 'Cogollos',
    smalls: 'PequeÃ±os',
    bags: 'Bolsas',
    rate: 'Ritmo',
    target: 'Meta',
    actual: 'Real',
    
    // Time
    today: 'Hoy',
    yesterday: 'Ayer',
    thisWeek: 'Esta Semana',
    lastWeek: 'Semana Pasada',
    
    // Status
    onTrack: 'En Meta',
    behind: 'Atrasado',
    ahead: 'Adelantado'
  }
};

let currentLanguage = 'en';

/**
 * Translation function - use for ALL user-facing text
 */
function t(key) {
  return labels[currentLanguage][key] || key;
}

/**
 * Set language and update all translated elements
 */
function setLanguage(lang) {
  currentLanguage = lang;
  localStorage.setItem('ro_language', lang);
  
  // Update all elements with data-i18n attribute
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.dataset.i18n;
    el.textContent = t(key);
  });
  
  // Update all elements with data-i18n-placeholder attribute
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.dataset.i18nPlaceholder;
    el.placeholder = t(key);
  });
}

/**
 * Initialize language from localStorage or browser
 */
function initLanguage() {
  const saved = localStorage.getItem('ro_language');
  if (saved) {
    setLanguage(saved);
  } else {
    // Detect browser language
    const browserLang = navigator.language.substring(0, 2);
    setLanguage(browserLang === 'es' ? 'es' : 'en');
  }
}
```

**HTML Usage**:
```html
<!-- Text content -->
<button data-i18n="save">Save</button>
<span data-i18n="loading">Loading...</span>

<!-- Placeholders -->
<input data-i18n-placeholder="search" placeholder="Search...">

<!-- Language toggle -->
<button onclick="setLanguage('en')">English</button>
<button onclick="setLanguage('es')">EspaÃ±ol</button>
```

### 5. Brand Colors CSS

```css
/**
 * Rogue Origin Design System
 * Use these CSS variables consistently across all apps
 */
:root {
  /* Primary Brand Colors */
  --ro-green: #668971;
  --ro-green-dark: #4a6b54;
  --ro-green-light: #8ba896;
  --ro-green-pale: #e8f0ea;
  
  /* Semantic Colors */
  --gold: #e4aa4f;
  --gold-dark: #c4903a;
  --danger: #c45c4a;
  --danger-dark: #a44a3a;
  --success: #5a9a6e;
  --warning: #d4a03c;
  --info: #5a8a9a;
  
  /* Dark Mode (Default) */
  --bg-main: #1a1a1a;
  --bg-card: #2d2d2d;
  --bg-card-hover: #3a3a3a;
  --bg-input: #252525;
  
  --text: #e0e0e0;
  --text-muted: #888888;
  --text-light: #aaaaaa;
  
  --border: #444444;
  --border-light: #555555;
  --border-focus: var(--ro-green);
  
  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.3);
  --shadow-md: 0 2px 4px rgba(0,0,0,0.3);
  --shadow-lg: 0 4px 8px rgba(0,0,0,0.3);
  
  /* Transitions */
  --transition-fast: 0.15s ease;
  --transition-normal: 0.3s ease;
  
  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  
  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;
}

/* Light Mode Override (if needed) */
body.light-mode {
  --bg-main: #f5f5f5;
  --bg-card: #ffffff;
  --bg-card-hover: #f0f0f0;
  --bg-input: #ffffff;
  
  --text: #333333;
  --text-muted: #666666;
  --text-light: #888888;
  
  --border: #dddddd;
  --border-light: #eeeeee;
  
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.1);
  --shadow-md: 0 2px 4px rgba(0,0,0,0.1);
  --shadow-lg: 0 4px 8px rgba(0,0,0,0.1);
}
```

### 6. Error Handling Pattern

```javascript
/**
 * Standard API call wrapper with error handling
 */
async function apiCall(action, data = null) {
  try {
    let response;
    
    if (data) {
      // POST request
      response = await fetch(`${API_URL}?action=${action}`, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(data),
        redirect: 'follow'
      });
    } else {
      // GET request
      response = await fetch(`${API_URL}?action=${action}`);
    }
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    const result = await response.json();
    
    if (result.error) {
      throw new Error(result.error);
    }
    
    return result;
    
  } catch (error) {
    console.error(`API Error (${action}):`, error);
    showToast(t('error') + ': ' + error.message, 'error');
    throw error;
  }
}

/**
 * Toast notification system
 */
function showToast(message, type = 'info', duration = 3000) {
  // Remove existing toasts
  document.querySelectorAll('.toast').forEach(t => t.remove());
  
  const toast = document.createElement('div');
  toast.className = `toast toast-${type}`;
  toast.textContent = message;
  
  toast.style.cssText = `
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 12px 24px;
    border-radius: var(--radius-md);
    color: white;
    font-weight: 500;
    z-index: 10000;
    animation: slideInRight 0.3s ease;
    background: ${
      type === 'error' ? 'var(--danger)' : 
      type === 'success' ? 'var(--success)' : 
      type === 'warning' ? 'var(--warning)' :
      'var(--ro-green)'
    };
  `;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.animation = 'slideOutRight 0.3s ease forwards';
    setTimeout(() => toast.remove(), 300);
  }, duration);
}

/**
 * CSS for toast animations (add to stylesheet)
 */
const toastStyles = `
@keyframes slideInRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slideOutRight {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(100%);
    opacity: 0;
  }
}
`;
```

### 7. Loading State Pattern

```javascript
/**
 * Show/hide loading overlay
 */
function setLoading(isLoading, message = null) {
  let overlay = document.getElementById('loadingOverlay');
  
  if (isLoading) {
    if (!overlay) {
      overlay = document.createElement('div');
      overlay.id = 'loadingOverlay';
      overlay.innerHTML = `
        <div class="loading-spinner"></div>
        <div class="loading-message">${message || t('loading')}</div>
      `;
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.7);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10001;
      `;
      document.body.appendChild(overlay);
    }
  } else {
    if (overlay) {
      overlay.remove();
    }
  }
}

/**
 * CSS for loading spinner
 */
const spinnerStyles = `
.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border);
  border-top-color: var(--ro-green);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.loading-message {
  margin-top: var(--spacing-md);
  color: var(--text);
  font-size: 14px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
`;
```

---

## Key Users & Personas

### ğŸ‘” The Boss (Owner)

**Profile**:
| Attribute | Value |
|-----------|-------|
| Primary Device | Mobile phone (iPhone) |
| Technical Level | Low - needs simple interfaces |
| Available Time | Very limited, always multitasking |
| Language | English |
| Location | Often remote/traveling |

**Key Questions** (in priority order):
1. "How are we doing today?" â†’ Production status
2. "How long to produce X amount?" â†’ Time estimates
3. "How many people working?" â†’ Crew count
4. "How much do we owe [Farm]?" â†’ Consignment balance (Phase 3)
5. "When will [Order] be done?" â†’ Order ETA (Phase 2)

**Pain Points**:
- Can't easily get quick answers while mobile
- Has to call/text Koa or floor lead for updates
- Spreadsheets are hard to read on phone
- Wants voice interaction while driving

**Design Requirements**:
- Large tap targets (min 44px)
- Fast load times (<2 seconds)
- Works offline when possible
- Voice-friendly responses (no complex tables)
- Dark mode for readability
- No complex navigation

**Success Metric**: Can get answer to top 5 questions in <10 seconds

---

### ğŸ‘· Production Floor Team (Hispanic Workers)

**Profile**:
| Attribute | Value |
|-----------|-------|
| Primary Device | Shared tablets, floor TV display |
| Technical Level | Low - basic smartphone users |
| Language | Spanish primary, limited English |
| Environment | Noisy, hands often busy |

**Key Tasks**:
1. View current progress on TV display
2. Log hourly production numbers
3. Adjust crew counts when people arrive/leave
4. Look up SOPs for procedures
5. Report issues/problems

**Pain Points**:
- Language barrier with English-only tools
- Complex interfaces are intimidating
- Hands are dirty/busy, hard to type
- Shared devices = no personal settings

**Design Requirements**:
- **Bilingual required** (Spanish/English toggle)
- Very large buttons and text
- Visual indicators (colors, icons) over text
- Minimal text input required
- Simple, single-purpose screens
- Works on TV display (read-only view)

**Success Metric**: Can complete hourly data entry in <30 seconds

---

### ğŸ› ï¸ Koa (Operations / Tool Builder)

**Profile**:
| Attribute | Value |
|-----------|-------|
| Primary Device | Desktop computer |
| Technical Level | High (vibe-coding with AI) |
| Language | English |
| Role | Jack-of-all-trades, operations |

**Key Tasks**:
1. Build and maintain operational tools
2. Fix bugs and issues
3. Improve processes using data
4. Train team on new tools
5. Document systems

**Pain Points**:
- Limited time for development (~10-15 hrs/week)
- Needs to maintain systems long-term
- Tools must work without constant fixes
- Documentation often gets outdated

**Design Requirements**:
- Good documentation (CLAUDE.md, etc.)
- Consistent code patterns
- Clear error messages
- Easy to extend/modify
- Version control (Git)

**Success Metric**: Can make changes confidently using Claude Code

---

## Project Roadmap

> Based on the official Rogue Origin Development Roadmap  
> Timeline assumes ~10-15 hours/week development time  
> Phases can overlap if resources allow

### Vision Statement

Transform Rogue Origin's operations into a data-driven, AI-assisted system that:
1. **Provides instant answers** to business questions across all data sources
2. **Gives customers visibility** into their orders
3. **Enables continuous improvement** through LEAN/Kaizen methodology
4. **Becomes a productizable platform** for other businesses

---

### âœ… Phase 1: AI Agent Foundation (Weeks 1-3) â€” ~70% COMPLETE

**Objective**: Create an AI assistant that can answer the boss's top 5 questions.

#### 1.1 Data Layer Standardization

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Unified API for production data | âœ… Done | getScoreboardData(), getBagTimerData() |
| Unified API for consignment data | ğŸ“‹ Pending | Phase 3 |
| Unified API for order data | ğŸ“‹ Pending | Phase 2 |
| Document API response formats | âœ… Done | APP_CATALOG.md |
| Error handling and validation | âœ… Done | Try/catch throughout |

#### 1.2 AI Agent Core

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Web interface with chat input | âœ… Done | ops-hub.html floating widget |
| Voice input (Web Speech API) | ğŸ“‹ Pending | Planned for Phase 4 |
| Voice output (Speech Synthesis) | ğŸ“‹ Pending | Planned for Phase 4 |
| Claude API integration | âœ… Done | claude-sonnet-4-20250514 |
| Mobile-responsive design | âœ… Done | Full-screen chat on mobile |

#### 1.3 Initial AI Tools

| Tool | Status | Function | Returns |
|------|--------|----------|---------|
| `get_production_today` | âœ… Done | getScoreboardData() | Lbs, crew, rate, % target |
| `get_production_rate` | âœ… Done | getScoreboardData() | Lbs/trimmer/hour |
| `get_consignment_balance` | ğŸ“‹ Phase 3 | (TBD) | Total owed by farm |
| `get_crew_count` | âœ… Done | getScoreboardData() | Current trimmers/buckers |
| `get_order_progress` | ğŸ“‹ Phase 2 | (TBD) | % complete, ETA |

#### 1.4 Integration with Ops Dashboard

| Deliverable | Status | Notes |
|-------------|--------|-------|
| AI chat component added | âœ… Done | Floating ğŸŒ¿ button |
| Mobile-friendly design | âœ… Done | Full-screen mode |
| Quick action buttons | âœ… Done | Status, Bags, Rate, Crew |
| Feedback system | âœ… Done | ğŸ‘/ğŸ‘ buttons |
| Correction learning | âœ… Done | "Actually..." detection |

**Phase 1 Success Criteria**:
- âœ… Boss can ask "How are we doing today?" â†’ Accurate answer
- ğŸ“‹ Boss can ask "How much do we owe Mountain Farm?" â†’ Needs Phase 3
- ğŸ“‹ Boss can ask "When will Hamburg order be done?" â†’ Needs Phase 2
- ğŸ“‹ Works on mobile via voice â†’ Needs voice implementation

---

### âœ… Phase 2: Customer Order Dashboard (Weeks 3-5) â€” ~80% COMPLETE

**Objective**: Give wholesale customers visibility into their orders with a professional, branded experience.

#### 2.1 Order Data Restructure

| Deliverable | Status | Target |
|-------------|--------|--------|
| Create clean Orders schema | âœ… Done | In orders.html |
| Migrate Hamburg order data | âœ… Done | Demo data included |
| Connect to production for progress | ğŸ“‹ Pending | Need backend API |

**Implemented Orders Schema**:
```
Order Object:
{
  id: 'ORD-001',
  customer: 'Hamburg GmbH',
  totalKg: 1400,
  completedKg: 580,
  status: 'pending|processing|ready|shipped|completed',
  createdDate: '2025-12-15',
  dueDate: '2026-02-01',
  notes: 'Order notes...',
  pallets: [
    { id: 'P001', cultivars: 'Sour Lifter, Lifter', weightKg: 300, status: 'completed' },
    ...
  ]
}
```

#### 2.2 Customer Portal

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Private link access (no login) | âœ… Done | Base64-encoded order ID |
| Order overview page | âœ… Done | Progress %, kg remaining |
| Pallet breakdown view | âœ… Done | Status per pallet |
| Current pallet detail | âœ… Done | Cultivars, weight, status |
| TIVE tracking embed/link | ğŸ“‹ Deferred | Add later |
| RO branding | âœ… Done | Professional green/gold theme |

**Customer Portal URL**:
```
https://rogueff.github.io/rogue-origin-apps/order.html?id={base64EncodedOrderId}
```

#### 2.3 Internal Order Management

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Order entry form | âœ… Done | orders.html modal |
| Pallet configuration | âœ… Done | Add/remove pallets with cultivars |
| Status updates | âœ… Done | Dropdown per order/pallet |
| Commercial invoice generation | ğŸ“‹ Pending | Future enhancement |
| COA attachment workflow | ğŸ“‹ Pending | Future enhancement |

**New Files**:
- `orders.html` - Internal order management UI
- `order.html` - Customer-facing order portal

**AI Integration** (Pending):
- Add `get_order_progress(order_id)` tool
- Enable: "When will the Hamburg order be done?"
- Enable: "What's the status of order #123?"

**Phase 2 Success Criteria**:
- Customer can view order status via private link
- Sales rep can create/update orders without touching spreadsheets
- Processing floor knows what to work on today
- AI can answer "When will [order] be ready?"

---

### ğŸ“‹ Phase 3: Consignment System Rebuild (Weeks 5-7)

**Objective**: Replace manual spreadsheets with a proper consignment tracking system.

#### 3.1 Data Model

| Entity | Fields | Notes |
|--------|--------|-------|
| Partners | ID, Name, Contact, PaymentTerms | Farm/partner info |
| Intakes | ID, PartnerID, Date, Strain, GrossWeight, QCWeight, QCNotes | Received material |
| Sales | ID, IntakeID, Date, Quantity, Price, Channel | Link to sold product |
| Payments | ID, PartnerID, Date, Amount, CheckNumber, Notes | Money paid out |

**Balance Calculation**:
```
Balance Owed = (Sum of Sales Ã— Partner Share) - (Sum of Payments)
```

#### 3.2 Internal Interface

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Partner dashboard | ğŸ“‹ Planned | Balances, inventory, history |
| Intake entry form | ğŸ“‹ Planned | Log received material |
| Payment entry form | ğŸ“‹ Planned | Record payments |
| Inventory reconciliation | ğŸ“‹ Planned | What's still in house |
| Margin analysis | ğŸ“‹ Planned | Sell price vs cost |

#### 3.3 Partner Portal (Future)

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Private link per partner | ğŸ’­ Future | Like order portal |
| Their inventory levels | ğŸ’­ Future | What we have of theirs |
| Sales history | ğŸ’­ Future | When/where sold |
| Payment history | ğŸ’­ Future | What we've paid |

**AI Integration**:
- Add `get_consignment_balance(farm_name)` tool
- Enable: "How much do we owe Mountain Farm?"
- Enable: "What consignment inventory do we have?"

**Phase 3 Success Criteria**:
- Can answer "How much do we owe X farm?" instantly
- Partners can see their own data (if enabled)
- No more manual spreadsheet reconciliation
- Zero over/under payment disputes

---

### ğŸ“‹ Phase 4: Processing Floor Enhancement (Weeks 7-9)

**Objective**: Make the hour-by-hour system easier for floor workers to use.

#### 4.1 Shop Floor Display

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Large-format TV view | âš ï¸ Partial | scoreboard.html exists |
| Current hour progress | âš ï¸ Partial | Needs visual enhancement |
| Target vs actual (color-coded) | âœ… Done | Green/red indicators |
| Daily totals and trends | âœ… Done | Chart included |
| Auto-refresh | âœ… Done | 30-second interval |

#### 4.2 Mobile Input App

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Simple hourly data entry | ğŸ“‹ Planned | New streamlined UI |
| Big buttons, minimal text | ğŸ“‹ Planned | Touch-optimized |
| Bilingual (ES/EN) | âš ï¸ Partial | Labels exist, needs UI work |
| Crew count adjustment | âœ… Done | CrewChangeSidebar |
| Break/lunch handling | âœ… Done | Timer pause/resume |

#### 4.3 AI Voice Assistant

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Voice input (Web Speech API) | ğŸ“‹ Planned | Browser native |
| Voice output (Speech Synthesis) | ğŸ“‹ Planned | Browser native |
| Spanish language support | ğŸ“‹ Planned | "Â¿CuÃ¡ntas libras hoy?" |
| Simple, clear responses | âœ… Done | AI prompt guidelines |

**Implementation Notes**:
```javascript
// Web Speech API for voice input
const recognition = new webkitSpeechRecognition();
recognition.lang = 'es-ES'; // Spanish
recognition.onresult = (event) => {
  const transcript = event.results[0][0].transcript;
  sendToAI(transcript);
};

// Speech Synthesis for voice output
const utterance = new SpeechSynthesisUtterance(response);
utterance.lang = 'es-ES';
speechSynthesis.speak(utterance);
```

**Phase 4 Success Criteria**:
- Floor supervisor can update hourly data in <30 seconds
- Team can see progress at a glance on TV display
- Language barrier is eliminated for basic questions
- Voice queries work in Spanish

---

### ğŸ“‹ Phase 5: Value Stream Mapping (Weeks 9-12)

**Objective**: Create framework for capturing upstream (growing) data in preparation for next season.

#### 5.1 Activity Tracking System

| Deliverable | Status | Notes |
|-------------|--------|-------|
| QR code generation | ğŸ“‹ Planned | Per activity type |
| Mobile scan-to-start/stop | ğŸ“‹ Planned | Simple time tracking |
| Activity types | ğŸ“‹ Planned | Irrigation, Pest, Harvest, etc. |
| Location tracking | ğŸ“‹ Planned | Which block/field |
| Duration calculation | ğŸ“‹ Planned | Automatic from scans |

**Activity Types**:
- Irrigation
- Pest Management
- Fertilization
- Pruning/Training
- Harvest
- Drying Management
- Equipment Maintenance

#### 5.2 Weather Integration

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Automated weather capture | ğŸ“‹ Planned | Free API (OpenWeather) |
| Historical data storage | ğŸ“‹ Planned | Daily high/low/precip |
| Correlation analysis | ğŸ“‹ Planned | Weather vs outcomes |

#### 5.3 Value Stream Map

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Visual process flow | ğŸ“‹ Planned | From seed to sale |
| Cycle time definitions | ğŸ“‹ Planned | Per stage |
| Data collection points | ğŸ“‹ Planned | Where to measure |
| Baseline establishment | ğŸ“‹ Planned | Current state metrics |

#### 5.4 Season Planning Dashboard

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Working day calendar | ğŸ“‹ Planned | Excluding holidays |
| Weather forecast | ğŸ“‹ Planned | 10-day planning |
| Resource planning | ğŸ“‹ Planned | People, equipment |
| Milestone tracking | ğŸ“‹ Planned | Key dates |

**Phase 5 Success Criteria**:
- Know labor hours for irrigation vs pest vs harvest
- Can correlate weather with outcomes
- Have baseline data for next season's improvements
- 80%+ of field labor hours categorized

---

### ğŸ¯ Phase 6: Product Packaging (Ongoing)

**Objective**: Generalize Rogue Origin tools for sale to other businesses.

#### 6.1 White-Label Capability

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Customizable branding | ğŸ’­ Future | Colors, logo, name |
| Configurable data fields | ğŸ’­ Future | Custom terminology |
| Modular feature set | ğŸ’­ Future | Enable/disable apps |

#### 6.2 Multi-Tenant Architecture

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Separate data per customer | ğŸ’­ Future | Per-org sheets |
| Subscription management | ğŸ’­ Future | Billing integration |
| Usage tracking | ğŸ’­ Future | Analytics |

#### 6.3 Documentation

| Deliverable | Status | Notes |
|-------------|--------|-------|
| User guides | ğŸ’­ Future | End-user docs |
| Setup guides | ğŸ’­ Future | Onboarding |
| API documentation | âš ï¸ Partial | APP_CATALOG.md |

#### 6.4 Proof Points

| Deliverable | Status | Notes |
|-------------|--------|-------|
| Rogue Origin case study | ğŸ’­ Future | Success story |
| ROI calculations | ğŸ’­ Future | Time/money saved |
| Before/after metrics | ğŸ’­ Future | Concrete numbers |

---

### Technical Dependencies by Phase

| Phase | Dependency | Status | Notes |
|-------|------------|--------|-------|
| 1 | Claude API key | âœ… Have it | Script Properties |
| 1 | Apps Script deployment | âœ… Done | Production live |
| 1 | Web Speech API | â³ Browser-native | No setup needed |
| 2 | Customer hosting | âœ… GitHub Pages | Already configured |
| 2 | TIVE API access | â“ TBD | Need to investigate |
| 3 | Shopify API | â³ Available | For sales linkage |
| 3 | PDF generation | â³ jsPDF library | For invoices |
| 4 | TV display hardware | âœ… Have it | Floor TV exists |
| 4 | Mobile devices | âœ… Have them | Shared tablets |
| 5 | QR code printing | âœ… Barcode printer | Existing hardware |
| 5 | Weather API | â³ OpenWeather free | Rate limited |

---

### Risk Mitigation

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Team resistance to new tools | Medium | High | Start simple, get wins, build trust |
| Data quality issues | High | Medium | Validate on input, clean incrementally |
| Scope creep | High | Medium | Stick to phase boundaries, document "future" ideas |
| Boss too busy to test | Medium | High | Schedule dedicated 15-min feedback sessions |
| Technical complexity | Low | High | Keep it simple - Sheets + Apps Script proven |
| API rate limits | Low | Medium | Cache responses, batch requests |
| Staff turnover | Medium | Medium | Good documentation, simple interfaces |

---

### Success Metrics

| Phase | Metric | Target | Measurement |
|-------|--------|--------|-------------|
| 1 | Time to answer boss's question | <10 seconds | Stopwatch test |
| 1 | Boss daily AI usage | Within 2 weeks | Chat log count |
| 2 | Status update emails | Reduce 80% | Email count |
| 2 | Order miscommunications | Zero | Issue tracking |
| 3 | Consignment reconciliation time | Hours â†’ Minutes | Time tracking |
| 3 | Payment disputes | Zero | Issue tracking |
| 4 | Hourly data entry time | <30 seconds | Observation |
| 4 | Target visibility | 100% of floor | Survey |
| 5 | Labor hours categorized | 80%+ | System data |
| 5 | Season baseline captured | Full season | Data completeness |

---

### Review Cadence

| Frequency | Meeting | Purpose | Attendees |
|-----------|---------|---------|-----------|
| Weekly | 15-min check-in | Current phase progress | Koa + Boss |
| Phase End | 1-hour demo | Demo + retrospective + planning | Koa + Boss |
| Monthly | 30-min review | Business impact assessment | Boss |

---

## Development Guidelines

### Adding New Features

1. **Check CLAUDE.md** - Look for existing patterns
2. **Check APP_CATALOG.md** - Technical details for specific app
3. **Bilingual required** - All user-facing text needs EN + ES
4. **Mobile-first** - If boss will use it, design for phone first
5. **Dual-mode** - If needs API, support both Apps Script and fetch
6. **Test thoroughly** - Test in both environments
7. **Update docs** - Add to APP_CATALOG.md and CLAUDE.md

### Editing AI Agent

1. **Data gathering**: Add to `gatherProductionContext()` or create new function
2. **System prompt**: Update `buildSystemPrompt()` with new data section
3. **Test locally**: Run `testAIAgent()` in Apps Script
4. **Deploy**: Create new version in Apps Script
5. **Clear cache**: Hard refresh browser (Ctrl+Shift+R)

### Deploying Changes

**Frontend (GitHub Pages)**:
```bash
cd rogue-origin-apps
git add .
git commit -m "Description of changes"
git push origin main
# Wait ~1-2 minutes for GitHub Pages to update
# Clear browser cache if needed (Ctrl+Shift+R)
```

**Backend (Apps Script)**:
1. Open Google Sheet â†’ Extensions â†’ Apps Script
2. Edit Code.gs (paste new code)
3. Save (Ctrl+S)
4. Deploy â†’ Manage deployments
5. Click Edit (pencil icon) on active deployment
6. Version â†’ New version
7. Deploy
8. Test with `?action=test` endpoint

### Testing Checklist

**Before deploying**:
- [ ] Test in Apps Script editor (Run function directly)
- [ ] Test API endpoint: `fetch(URL + '?action=test')`
- [ ] Test chat: Send test message through widget
- [ ] Check console for errors (F12)
- [ ] Test on mobile viewport
- [ ] Test both languages (EN/ES)

**After deploying**:
- [ ] Hard refresh browser (Ctrl+Shift+R)
- [ ] Verify new version number in deployment
- [ ] Test in incognito window
- [ ] Check AI_Chat_Log for successful entries

---

## Troubleshooting Guide

### Common Issues

#### "Failed to fetch" Error

**Symptoms**: Chat shows "Failed to fetch" or "Network error"

**Causes & Solutions**:

| Cause | Solution |
|-------|----------|
| CORS preflight blocked | Use `text/plain` content type, not `application/json` |
| Apps Script not deployed | Deploy â†’ Manage deployments â†’ Create new version |
| Wrong deployment URL | Copy URL from Deploy â†’ Manage deployments |
| API key missing | Check Script Properties for ANTHROPIC_API_KEY |
| Browser cache | Hard refresh (Ctrl+Shift+R) |

**Debug steps**:
```javascript
// Test in browser console
fetch('YOUR_URL?action=test')
  .then(r => r.json())
  .then(console.log)
  .catch(console.error);
```

#### AI Not Responding

**Symptoms**: Chat shows typing indicator but never responds

**Causes & Solutions**:

| Cause | Solution |
|-------|----------|
| API key invalid | Regenerate at console.anthropic.com |
| API key not in Script Properties | File â†’ Project Settings â†’ Script Properties |
| Rate limit exceeded | Wait and retry |
| Request timeout | Check Apps Script execution log |

**Debug steps**:
```javascript
// Run in Apps Script editor
function testAPI() {
  var result = handleChatRequest({
    message: 'test',
    history: []
  });
  Logger.log(JSON.stringify(result));
}
```

#### Stale Data Showing

**Symptoms**: Dashboard shows old numbers

**Causes & Solutions**:

| Cause | Solution |
|-------|----------|
| Browser cache | Hard refresh (Ctrl+Shift+R) |
| Apps Script cache | Wait 5 minutes or trigger fresh read |
| Old deployment | Verify deployment version is latest |
| Sheet not updated | Check source sheet data |

#### Bilingual Not Working

**Symptoms**: Spanish translations not showing

**Causes & Solutions**:

| Cause | Solution |
|-------|----------|
| Missing translation | Add key to `labels` object |
| Wrong data attribute | Use `data-i18n` not `data-translate` |
| Language not saved | Check `localStorage.getItem('ro_language')` |
| Init not called | Add `initLanguage()` to page load |

### Apps Script Execution Logs

**How to access**:
1. Open Apps Script editor
2. View â†’ Executions
3. Click on specific execution to see details

**What to look for**:
- Error messages
- Execution time (timeout is 6 minutes)
- Function that was called
- User who triggered it

### Browser Console Debugging

**Common console commands**:
```javascript
// Check if widget loaded
typeof aiSendMessage  // Should return "function"

// Check language setting
localStorage.getItem('ro_language')

// Test API manually
fetch('URL?action=test').then(r=>r.json()).then(console.log)

// Check for JavaScript errors
// Look for red text in Console tab

// Network tab
// Look for failed requests (red) or slow requests (>5s)
```

### Getting Help

1. **Check this document first** - Most answers are here
2. **Search chat history** - We may have solved it before
3. **Check Apps Script logs** - Executions show errors
4. **Check browser console** - F12 â†’ Console tab
5. **Ask Claude Code** - Open project and describe issue

---

## Appendix

### File Checksums (For Version Verification)

| File | Version | Last Updated | Lines |
|------|---------|--------------|-------|
| ops-hub.html | 2.0 | Jan 2, 2026 | ~2,300 |
| Code.gs (Production) | 2.0 | Jan 2, 2026 | ~1,900 |
| Code.gs (Barcode) | 1.0 | 2024 | ~300 |
| CLAUDE.md | 2.0 | Jan 2, 2026 | ~1,200 |
| APP_CATALOG.md | 2.0 | Jan 2, 2026 | ~600 |
| CODEBASE_INVENTORY.md | 2.0 | Jan 2, 2026 | ~500 |

### Quick Copy-Paste References

**Production API URL**:
```
https://script.google.com/macros/s/AKfycbxDAHSFl9cedGS49L3Lf5ztqy-SSToYigyA30ZtsdpmWNAR9H61X_Mm48JOOTGqqr-Z/exec
```

**Production Sheet ID**:
```
1dARXrKU2u4KJY08ylA3GUKrT0zwmxCmtVh7IJxnn7is
```

**Barcode Sheet ID**:
```
1JQRU1-kW5hLcAdNhRvOvvj91fhezBE_-StN5X1Ni6zE
```

**AI Model**:
```
claude-sonnet-4-20250514
```

**Brand Color**:
```
#668971
```

---

*This document is the source of truth for Claude Code context. Keep it updated as the system evolves.*
