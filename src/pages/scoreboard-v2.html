<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <link rel="icon" type="image/png" href="/rogue-origin-apps/favicon.png">
  <link rel="manifest" href="/rogue-origin-apps/manifest.json">
  <meta name="theme-color" content="#0a0c0b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="RO Ops">
  <link rel="apple-touch-icon" href="/rogue-origin-apps/assets/icon-apple-touch.png">
  <title>Production Scoreboard V2</title>

  <!-- TV Mode Detection: Apply before render to prevent flash -->
  <script>
    (function() {
      var urlParams = new URLSearchParams(window.location.search);
      var urlTvMode = urlParams.get('tv') === '1';
      var storedTvMode = localStorage.getItem('tvMode') === 'true';
      if (urlTvMode || storedTvMode) {
        document.documentElement.classList.add('tv-mode');
      }
    })();
  </script>

  <!-- Performance: Resource Hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://unpkg.com">
  <link rel="dns-prefetch" href="https://script.google.com">

  <!-- Fonts: Cinematic Instrument Panel -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400&family=Space+Mono:wght@400;700&family=Inter:wght@400;500;600;700;800;900&display=optional" rel="stylesheet">

  <!-- Scripts: Lazy loaded by modules when needed -->
  <!-- Chart.js and Phosphor Icons are loaded on-demand by lazy-loader.js -->

  <!-- Scoreboard V2 Modules -->
  <script defer src="../js/scoreboard-v2/config.js?v=2"></script>
  <script defer src="../js/scoreboard-v2/state.js?v=2"></script>
  <script defer src="../js/scoreboard-v2/dom.js?v=2"></script>
  <script defer src="../js/scoreboard-v2/i18n.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/api.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/timer.js?v=10"></script>
  <script defer src="../js/scoreboard-v2/cycle-history.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/chart.js?v=4"></script>
  <script defer src="../js/scoreboard-v2/render.js?v=4"></script>
  <script defer src="../js/scoreboard-v2/shift-start.js?v=4"></script>
  <script defer src="../js/scoreboard-v2/morning-report.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/scale.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/debug.js?v=1"></script>
  <script defer src="../js/scoreboard-v2/events.js?v=3"></script>
  <script defer src="../js/scoreboard-v2/fab-menu.js?v=1"></script>
  <script defer src="../js/scoreboard-v2/main.js?v=10"></script>

  <!-- Critical CSS: Loaded synchronously -->
  <link rel="stylesheet" href="../css/shared-base.css">

  <!-- Non-critical CSS: Deferred for faster initial render -->
  <link rel="preload" href="../css/scoreboard-v2.css?v=4" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="../css/scoreboard-v2.css?v=4"></noscript>
</head>
<body class="idle timer-neutral">
  <a href="#main-panel" class="skip-link">Skip to main content</a>

  <!-- ============================================
       MORNING REPORT (full-screen overlay)
       ============================================ -->
  <div id="morningReportContainer">
    <div class="mr-header">
      <div>
        <div class="mr-title">MORNING REPORT / REPORTE MATUTINO</div>
        <div class="mr-subtitle" id="mrDate">Loading...</div>
      </div>
      <button class="mr-back-btn">
        <i class="ph-duotone ph-arrow-left"></i>
        Back to Live / Volver en Vivo
      </button>
    </div>
    <div id="morningReportContent"></div>
  </div>

  <!-- ============================================
       HISTORICAL DATE BANNER
       ============================================ -->
  <div id="historicalDateBanner" class="historical-date-banner" style="display:none;">
    <div class="historical-banner-content">
      <i class="ph-duotone ph-calendar-blank"></i>
      <span class="historical-banner-label">Viewing Historical Data:</span>
      <span id="historicalDateDisplay" class="historical-banner-date">‚Äî</span>
    </div>
    <button class="historical-banner-close" title="Back to live view">
      <i class="ph-duotone ph-x"></i>
      Back to Live
    </button>
  </div>

  <!-- ============================================
       CINEMATIC HEADER ‚Äî Floating strain + clock
       ============================================ -->
  <header class="hud-header">
    <div class="strain-display">
      <div class="strain-label" id="strainLabel">Line 1 ¬∑ Current Strain</div>
      <div class="strain-name" id="strainName">‚Äî</div>
      <div class="strain-rate-indicator" id="strainRateIndicator"></div>
    </div>

    <div class="hud-center-marker">
      <!-- Status Badge -->
      <div class="status-badge">
        <span class="status-icon" id="statusIcon"><i class="ph-duotone ph-pause"></i></span>
        <span id="statusText">WAITING</span>
      </div>
    </div>

    <div class="time-display">
      <div class="time" id="clock">--:--</div>
      <div class="date" id="date">Loading...</div>
    </div>
  </header>

  <!-- Time Controls -->
  <div class="time-controls">
    <button id="startDayBtn" class="start-day-btn pulse-green" style="display:none;">
      <i class="ph-duotone ph-play-circle"></i>
      Start Day
    </button>
    <div id="startedBadge" class="started-badge" style="display:none;">
      <i class="ph-duotone ph-clock"></i>
      Started: <span id="startTimeDisplay">‚Äî</span>
      <i id="badgeIcon" class="ph-duotone ph-pencil-simple"></i>
    </div>
  </div>

  <!-- Date Picker Input (hidden) -->
  <input type="date" id="historicalDatePicker" class="date-picker-hidden" aria-label="Select historical date to view past production data">

  <!-- Morning Report Button (hidden ‚Äî moved to FAB) -->
  <button id="morningReportBtn">
    <i class="ph-duotone ph-chart-bar"></i>
    Morning Report / Reporte Matutino
  </button>

  <!-- Historical View Button (hidden ‚Äî moved to FAB) -->
  <button id="historicalViewBtn" class="historical-view-btn">
    <i class="ph-duotone ph-clock-counter-clockwise"></i>
    Past Data
  </button>

  <!-- Order Queue Toggle Button (hidden ‚Äî moved to FAB) -->
  <button id="orderQueueToggleBtn" class="order-queue-toggle-btn" title="Toggle Order Queue / Alternar Cola de Pedidos">
    <i class="ph-duotone ph-stack"></i>
    <span id="orderQueueToggleText">Orders</span>
  </button>

  <!-- Lang / TV / Complaints toggles -->
  <div class="lang-toggle">
    <button class="lang-btn active" id="langToggleBtn">
      <span id="langToggleText">EN</span>
    </button>
    <button class="lang-btn" id="tvModeToggleBtn" title="TV Mode (65% scale for 4K displays)">
      <i class="ph-duotone ph-television"></i>
    </button>
    <a href="https://docs.google.com/spreadsheets/d/1SyeueGF5NY3AXvUJYLTjuK01v3jCPIpbs9JQbrhrlHk/edit?gid=0#gid=0" target="_blank" class="lang-btn complaints-btn" title="Customer Complaints / Quejas de Clientes">
      <i class="ph-duotone ph-warning-circle"></i>
    </a>
  </div>

  <button class="help-btn">?</button>

  <!-- ============================================
       HELP MODAL
       ============================================ -->
  <div class="help-modal" id="helpModal" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="help-content">
      <div class="help-header">
        <div class="help-title" id="helpTitle"><i class="ph-duotone ph-chart-pie-slice" style="margin-right:8px"></i> Understanding the Scoreboard</div>
        <button class="help-close">‚úï</button>
      </div>
      <div class="help-grid">
        <div class="help-item">
          <div class="help-item-title"><i class="ph-duotone ph-package" style="margin-right:6px"></i> Last Hour (Completed)</div>
          <div class="help-item-desc" id="helpLastHour">Production from the last completed hour. Target adjusts for breaks.</div>
        </div>
        <div class="help-item">
          <div class="help-item-title"><i class="ph-duotone ph-timer" style="margin-right:6px"></i> Current Hour</div>
          <div class="help-item-desc" id="helpCurrentHour">Current crew count and target for the hour in progress.</div>
        </div>
        <div class="help-item">
          <div class="help-item-title"><i class="ph-duotone ph-trend-up" style="margin-right:6px"></i> Today's Progress</div>
          <div class="help-item-desc" id="helpToday">Total so far vs target. "Up 5.2" = 5.2 lbs ahead of target.</div>
        </div>
        <div class="help-item">
          <div class="help-item-title">üîÆ End of Day</div>
          <div class="help-item-desc" id="helpProjection">Projected final output if you maintain current pace.</div>
        </div>
        <div class="help-item">
          <div class="help-item-title">üéØ Target Rate</div>
          <div class="help-item-desc" id="helpTarget">Expected lbs/trimmer/hr based on this strain's 30-day history.</div>
        </div>
        <div class="help-item">
          <div class="help-item-title">‚è≤ Bag Timer</div>
          <div class="help-item-desc" id="helpTimer">Time since last 5kg bag. Tracks pace between completions.</div>
        </div>
      </div>
      <div class="help-colors">
        <div class="help-color"><div class="help-dot green"></div><span id="helpGreen">Green = Ahead (105%+)</span></div>
        <div class="help-color"><div class="help-dot yellow"></div><span id="helpYellow">Yellow = On Target (90-105%)</span></div>
        <div class="help-color"><div class="help-dot red"></div><span id="helpRed">Red = Behind (&lt;90%)</span></div>
      </div>
    </div>
  </div>

  <!-- ============================================
       MAIN STAGE ‚Äî Cinematic split layout
       ============================================ -->
  <div id="main-panel" class="main-panel">
    <div class="scoreboard">

      <!-- ====== HERO: DAILY TOTAL ‚Äî Massive, unmissable ====== -->
      <div class="hero-daily">
        <div class="daily-progress">
          <div class="daily-header" id="dailyHeader">Line 1 Today</div>
          <div class="daily-numbers">
            <span class="daily-actual" id="dailyActual">‚Äî</span>
            <span class="daily-sep">/</span>
            <span class="daily-target" id="dailyTarget">‚Äî</span>
            <span class="daily-unit">lbs</span>
            <span class="daily-delta" id="dailyDelta">‚Äî</span>
          </div>
          <div class="progress-bar-container">
            <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
            <span class="progress-hours" id="progressHours">0 hrs</span>
          </div>
          <div class="daily-projection">
            <span class="projection-label" id="projectionLabel">End of day:</span>
            <span class="projection-value" id="projectionValue">‚Äî</span>
            <span class="projection-goal" id="projectionGoal"></span>
            <span class="projection-delta" id="projectionDelta">‚Äî</span>
          </div>
        </div>
      </div>

      <!-- ====== HOUR CARDS ‚Äî Staggered, overlapping ====== -->
      <div class="hour-cards">
        <div class="hour-card last-hour">
          <div class="hour-card-header" id="lastHourHeader">Last Hour</div>
          <div class="hour-card-timeslot" id="lastHourTimeslot">‚Äî</div>
          <div class="lbs-row">
            <span class="actual-lbs" id="lastHourLbs">‚Äî</span>
            <span class="separator">/</span>
            <span class="target-lbs" id="lastHourTarget">‚Äî</span>
          </div>
          <div class="lbs-unit" id="lbsUnit">lbs</div>
          <div class="percentage-display">
            <div class="percentage-value" id="lastHourPct">‚Äî%</div>
            <div class="percentage-label" id="ofTargetLabel">of target</div>
          </div>
        </div>

        <div class="hour-card current-hour" id="currentHourCard" style="display:none;">
          <div class="hour-card-header" id="currentHourHeader"><i class="ph-duotone ph-timer" style="margin-right:6px"></i> Current Hour</div>
          <div class="hour-card-timeslot" id="currentHourTimeslot">‚Äî</div>
          <div class="lbs-row">
            <span class="actual-lbs" id="currentHourTrimmers">‚Äî</span>
            <span class="lbs-unit" style="font-size:14px;margin-left:8px" id="trimmersSmallLabel">trimmers</span>
          </div>
          <div class="percentage-display">
            <div class="percentage-value" id="currentHourTargetLbs">‚Äî</div>
            <div class="percentage-label" id="lbsTargetLabel">lbs target</div>
          </div>
        </div>
      </div>

      <!-- Order Queue Section -->
      <div class="order-queue-section" id="orderQueueSection" style="display:none;">
        <div class="order-pill" id="currentOrderPill">
          <div class="order-pill-header">
            <span class="order-icon">üéØ</span>
            <span class="order-label" id="currentOrderLabel">WORKING ON</span>
            <span class="order-summary" id="currentOrderSummary">‚Äî</span>
            <span class="expand-icon">‚ñº</span>
          </div>
          <div class="order-progress-bar-container" id="currentProgressBarContainer" style="display:none;">
            <div class="order-progress-bar">
              <div class="order-progress-fill" id="currentProgressFill" style="width:0%"></div>
            </div>
            <span class="order-progress-text" id="currentProgressText">0 / 0 kg</span>
          </div>
          <div class="order-detail" id="currentOrderDetail"></div>
        </div>
        <div class="order-pill next" id="nextOrderPill">
          <div class="order-pill-header">
            <span class="order-icon">‚è≠</span>
            <span class="order-label" id="nextOrderLabel">UP NEXT</span>
            <span class="order-summary" id="nextOrderSummary">‚Äî</span>
            <span class="expand-icon">‚ñº</span>
          </div>
          <div class="order-detail" id="nextOrderDetail"></div>
        </div>
      </div>

      <!-- Comparisons -->
      <div class="comparisons">
        <div class="comparison-pill" id="vsYesterdayPill" style="display:none"><span class="comparison-label" id="vsYesterdayLabel">vs Yesterday</span><span class="comparison-value" id="vsYesterdayValue">‚Äî</span></div>
        <div class="comparison-pill" id="vs7DayPill" style="display:none"><span class="comparison-label" id="vs7DayLabel">vs 7-Day Avg</span><span class="comparison-value" id="vs7DayValue">‚Äî</span></div>
        <div class="comparison-pill streak-pill" id="streakPill" style="display:none"><span class="streak-icon"><i class="ph-duotone ph-fire"></i></span><span class="streak-value" id="streakValue">0</span><span class="comparison-label" id="streakLabel">hr streak</span></div>
      </div>

      <!-- Info Bar -->
      <div class="info-bar">
        <div class="info-section"><span class="info-icon"><i class="ph-duotone ph-users-three"></i></span><span><span id="crewCount">‚Äî</span> <span id="trimmersLabel">Trimmers</span></span></div>
        <div class="info-divider"></div>
        <div class="info-section"><span class="info-icon"><i class="ph-duotone ph-crosshair"></i></span><span><span id="targetRateLabel">Target:</span> <span id="targetRate">‚Äî</span> lbs/hr</span></div>
        <div class="info-divider" id="avgBestDivider"></div>
        <div id="avgBestContainer" class="avg-best-container">
          <div class="stat-group" id="avgGroup"><span class="label" id="avgTargetLabel">AVG</span><span class="value" id="avgPercentage">‚Äî</span></div>
          <div class="info-divider" id="bestDivider"></div>
          <div class="stat-group" id="bestGroup"><span class="label" id="bestHourLabel">BEST</span><span class="value" id="bestHour">‚Äî</span></div>
        </div>
        <button class="avg-best-toggle" id="avgBestToggle" title="Toggle AVG/BEST">
          <i class="ph-duotone ph-chart-bar"></i>
        </button>
      </div>

      <!-- Hourly Rate Chart -->
      <div class="chart-container" id="chartContainer" style="display:none;">
        <div class="chart-header" id="chartHeader">Hourly Performance (lbs/trimmer)</div>
        <div class="chart-wrapper">
          <canvas id="hourlyChart"></canvas>
        </div>
      </div>

    </div>
  </div>

  <!-- ============================================
       INSTRUMENT PANEL ‚Äî Right side
       Integrated cockpit feel
       ============================================ -->
  <div class="timer-panel neutral" id="timerPanel">
    <div class="drag-handle" id="dragHandle"></div>
    <div class="expand-hint" id="expandHint">‚óÄ</div>
    <button class="fullscreen-toggle" id="fullscreenToggle"><i class="ph-duotone ph-arrows-out"></i></button>

    <!-- Scale Ring -->
    <div class="scale-section" id="scaleSection">
      <div class="scale-header" id="scaleHeader">Live Scale</div>
      <div class="scale-display" id="scaleDisplay">
        <svg class="scale-ring" viewBox="0 0 220 220">
          <defs>
            <filter id="scaleGlow">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
          </defs>
          <!-- Tick marks for chronograph feel -->
          <g class="ring-ticks" transform="translate(110,110)">
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(0)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(36)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(72)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(108)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(144)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(180)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(216)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(252)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(288)"/>
            <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(324)"/>
          </g>
          <circle class="scale-ring-bg" cx="110" cy="110" r="95"/>
          <circle class="scale-ring-progress" id="scaleRing" cx="110" cy="110" r="95" stroke-dasharray="597" stroke-dashoffset="597" filter="url(#scaleGlow)"/>
        </svg>
        <div class="scale-center">
          <div class="scale-value" id="scaleWeight">‚Äî</div>
          <div class="scale-label" id="scaleWeightLabel">of 5.0 kg</div>
        </div>
        <div class="scale-status-dot" id="scaleStatusDot"></div>
      </div>
    </div>

    <!-- Bag Timer Ring -->
    <div class="timer-header" id="timerHeader">5KG Bag Timer</div>
    <div class="timer-display" id="timerDisplay">
      <svg class="timer-ring" viewBox="0 0 220 220">
        <defs>
          <filter id="timerGlow">
            <feGaussianBlur stdDeviation="4" result="blur"/>
            <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>
        <!-- Tick marks -->
        <g class="ring-ticks" transform="translate(110,110)">
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(0)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(30)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(60)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(90)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(120)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(150)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(180)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(210)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(240)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(270)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(300)"/>
          <line x1="0" y1="-92" x2="0" y2="-85" stroke="rgba(240,235,224,0.08)" stroke-width="1" transform="rotate(330)"/>
        </g>
        <circle class="timer-ring-bg" cx="110" cy="110" r="95"/>
        <circle class="timer-ring-progress green" id="timerRing" cx="110" cy="110" r="95" stroke-dasharray="597" stroke-dashoffset="0" filter="url(#timerGlow)"/>
      </svg>
      <div class="timer-center">
        <div class="timer-value green" id="timerValue">--:--</div>
        <div class="timer-label" id="timerLabel">remaining</div>
      </div>
    </div>

    <div class="timer-target">Target: <span id="timerTargetTime">--:--</span> ¬∑ <span id="timerTrimmers">0</span> trimmers</div>

    <!-- Button Row -->
    <div class="timer-btn-row">
      <button class="manual-btn" id="manualBtn"><span class="icon"><i class="ph-duotone ph-package"></i></span><span id="manualBtnText">5KG Bag Complete</span></button>
      <button class="pause-btn" id="pauseBtn"><i class="ph-duotone ph-pause"></i></button>
    </div>

    <!-- Timer Stats -->
    <div class="timer-stats">
      <div class="timer-stat"><span class="timer-stat-label" id="bagsTodayLabel">Bags Today</span><span class="timer-stat-value" id="bagsToday">0</span></div>
      <div class="timer-stat"><span class="timer-stat-label" id="avgTodayLabel">Avg Today</span><span class="timer-stat-value" id="avgToday">--:--</span></div>
      <div class="timer-stat"><span class="timer-stat-label" id="vsTargetLabel">vs Target</span><span class="timer-stat-value" id="vsTarget">‚Äî</span></div>
    </div>

    <!-- Cycle History -->
    <div class="cycle-history" id="cycleHistory">
      <div class="cycle-history-header">
        <span class="cycle-history-title" id="cycleHistoryTitle">Today's Cycles</span>
        <div class="cycle-history-nav">
          <button class="cycle-nav-btn" title="Previous view">‚Äπ</button>
          <span class="cycle-mode-label" id="cycleModeLabel">List</span>
          <button class="cycle-nav-btn" title="Next view">‚Ä∫</button>
          <button class="cycle-history-toggle" id="cycleToggle">Hide</button>
        </div>
      </div>
      <div class="cycle-content" id="cycleContent"></div>
    </div>
  </div>

  <!-- ============================================
       CELEBRATION
       ============================================ -->
  <div class="celebration" id="celebration"></div>

  <!-- ============================================
       PAUSE MODAL
       ============================================ -->
  <div class="pause-modal-overlay" id="pauseModal">
    <div class="pause-modal">
      <div class="pause-modal-title"><i class="ph-duotone ph-pause-circle"></i> Pause Timer</div>
      <div class="pause-modal-subtitle">Select or enter the reason for pausing:</div>
      <div class="pause-modal-reasons">
        <button class="pause-reason-btn">üîß Equipment issue</button>
        <button class="pause-reason-btn">üì¶ Material shortage</button>
        <button class="pause-reason-btn">üîç Quality check</button>
        <button class="pause-reason-btn">üë• Shift change</button>
        <button class="pause-reason-btn">üßπ Cleaning</button>
      </div>
      <input type="text" class="pause-custom-input" id="pauseCustomReason" placeholder="Or type a custom reason...">
      <div class="pause-modal-buttons">
        <button class="pause-modal-btn cancel">Cancel</button>
        <button class="pause-modal-btn confirm" id="pauseConfirmBtn" disabled>Pause Timer</button>
      </div>
    </div>
  </div>

  <!-- Pause Banner -->
  <div class="pause-banner" id="pauseBanner">
    <i class="ph-duotone ph-pause-circle" style="font-size:24px;"></i>
    <span>PAUSED</span>
    <span class="pause-banner-time" id="pauseTime">0:00</span>
    <span class="pause-banner-reason" id="pauseReasonDisplay">‚Äî</span>
  </div>

  <!-- ============================================
       DEBUG PANEL
       ============================================ -->
  <div class="debug-indicator" id="debugIndicator">‚ö† Debug Mode Active</div>
  <div class="debug-panel" id="debugPanel">
    <div class="debug-header">üõ† Timer Debug <button class="debug-close">‚úï</button></div>
    <div class="debug-controls">
      <div class="debug-label">Timer State:</div>
      <div class="debug-buttons">
        <button>üü¢ Green</button>
        <button>üü° Yellow</button>
        <button>üî¥ Red/Overtime</button>
        <button>‚ö´ Neutral</button>
      </div>
      <div class="debug-label">Simulate Time:</div>
      <div class="debug-buttons">
        <button>Just Started</button>
        <button>50%</button>
        <button>85% (Yellow)</button>
        <button>110% (Overtime)</button>
      </div>
      <div class="debug-label">Break Status:</div>
      <div class="debug-buttons">
        <button>Working</button>
        <button>On Break</button>
      </div>
      <div class="debug-label">Test Celebration:</div>
      <div class="debug-buttons">
        <button>üé∫ Early (Mariachi!)</button>
        <button>‚úì On Time</button>
        <button>‚ö† Overtime</button>
        <button style="background:rgba(34,197,94,0.3);border-color:#22c55e;">üîä Test Sound</button>
      </div>
      <div class="debug-divider"></div>
      <button class="debug-reset">‚Üª Reset to Live</button>
    </div>
    <div class="debug-hint">Press <kbd>D</kbd> to toggle this panel</div>
  </div>

  <!-- ============================================
       START DAY MODAL
       ============================================ -->
  <div id="startDayModal" class="modal-overlay" style="display:none;">
    <div class="modal-content start-day-modal">
      <h3 class="modal-title">
        <i class="ph-duotone ph-play-circle"></i>
        Set Shift Start Time
      </h3>
      <p class="modal-subtitle">What time did production begin today?</p>

      <div class="time-input-wrapper">
        <label for="startTimeInput">Start Time:</label>
        <input type="time" id="startTimeInput" class="time-input" />
      </div>

      <div class="impact-preview" id="impactPreview">
        <i class="ph-duotone ph-info"></i>
        <div class="impact-text">
          This will adjust daily goal by <span id="goalReduction">‚Äî</span>
          <div class="impact-details">
            <span id="originalGoal">200</span> lbs ‚Üí <span id="adjustedGoalPreview">‚Äî</span> lbs
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn-secondary">Cancel</button>
        <button class="btn-primary">Confirm</button>
      </div>
    </div>
  </div>

  <script src="../js/sw-register.js" async></script>

  <!-- Debug Module: Lazy-loaded on first use -->
  <script>
    (function() {
      var debugLoaded = false;
      var debugLoadPromise = null;
      document.addEventListener('keydown', function(e) {
        if (e.key === 'd' || e.key === 'D') {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
          if (!debugLoaded && !debugLoadPromise) {
            console.log('[Debug] Loading debug module...');
            debugLoadPromise = new Promise(function(resolve, reject) {
              var script = document.createElement('script');
              script.src = '../js/scoreboard-v2/debug.js?v=2';
              script.onload = function() {
                debugLoaded = true;
                console.log('[Debug] Module loaded successfully');
                resolve();
                if (window.toggleDebug) window.toggleDebug();
              };
              script.onerror = function() {
                debugLoadPromise = null;
                reject(new Error('Failed to load debug.js'));
                console.error('[Debug] Failed to load debug module');
              };
              document.head.appendChild(script);
            });
          } else if (debugLoaded && window.toggleDebug) {
            window.toggleDebug();
          }
        }
      });
    })();
  </script>

  <!-- ============================================
       FAB MENU
       ============================================ -->
  <div class="fab-backdrop" id="fabBackdrop"></div>
  <div class="fab-container">
    <div class="fab-menu" id="fabMenu" role="menu">
      <button class="fab-menu-item" id="fabStartDay" role="menuitem" style="display:none">
        <i class="ph-duotone ph-play"></i>
        <span>Start Day</span>
      </button>
      <button class="fab-menu-item" id="fabMorningReport" role="menuitem">
        <i class="ph-duotone ph-newspaper"></i>
        <span>Morning Report</span>
      </button>
      <button class="fab-menu-item" id="fabPastData" role="menuitem">
        <i class="ph-duotone ph-calendar"></i>
        <span>Past Data</span>
      </button>
      <button class="fab-menu-item" id="fabOrderQueue" role="menuitem">
        <i class="ph-duotone ph-package"></i>
        <span>Order Queue</span>
        <span class="fab-indicator" id="orderQueueIndicator">OFF</span>
      </button>
      <button class="fab-menu-item" id="fabChart" role="menuitem">
        <i class="ph-duotone ph-chart-bar"></i>
        <span>Hourly Chart</span>
        <span class="fab-indicator" id="chartIndicator">ON</span>
      </button>
      <button class="fab-menu-item" id="fabHelp" role="menuitem">
        <i class="ph-duotone ph-question"></i>
        <span>Help</span>
      </button>
    </div>
    <button class="fab-button" id="fabButton" aria-label="Menu" aria-expanded="false" aria-haspopup="true">
      <i class="ph-duotone ph-dots-three-outline-vertical"></i>
    </button>
  </div>
</body>
</html>
